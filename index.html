<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Académico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href="https://visjs.github.io/vis-timeline/styles/vis-timeline-graph2d.min.css" rel="stylesheet" type="text/css" />
    <!-- PDF Viewer Styles -->
    <link rel="stylesheet" href="assets/base.min.css"/>
    <link rel="stylesheet" href="assets/fancy.min.css"/>
    <link rel="stylesheet" href="assets/main.css?v=1.2"/>
	<link rel="stylesheet" href="assets/styles.css?v=1.2"/>
    <style>
	.loading-modal {
	  position: fixed;
	  top: 0;
	  left: 0;
	  width: 100%;
	  height: 100%;
	  background: rgba(0, 0, 0, 0.5); /* Semi-transparent black overlay */
	  backdrop-filter: blur(5px); /* Blur effect for background */
	  display: flex;
	  justify-content: center;
	  align-items: center;
	  z-index: 9999; /* Ensure it appears above other content */
	}
	
	.loading-spinner {
	  width: 50px;
	  height: 50px;
	  border: 5px solid #f3f3f3; /* Light gray border */
	  border-top: 5px solid #3498db; /* Blue spinner */
	  border-radius: 50%;
	  animation: spin 1s linear infinite; /* Continuous rotation */
	}
	
	@keyframes spin {
	  0% { transform: rotate(0deg); }
	  100% { transform: rotate(360deg); }
	}
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen flex flex-col">
        <!-- ---------------------------------- -->
	<!-- Component: Header -->
	<!-- ---------------------------------- -->
	<header class="bg-blue-600 text-white shadow-lg">
	    <div class="px-4 py-3">
	        <div class="flex flex-col md:flex-row md:justify-between md:items-center space-y-2 md:space-y-0">
	            <div class="flex items-center justify-between">
	                <h1 class="text-xl md:text-2xl font-bold">Calendario Académico 3-pf1-v9b</h1>
	                <div class="md:hidden">
	                    <button @click="setView('dayGridMonth')" :class="{'bg-blue-700': currentView === 'dayGridMonth'}" class="p-2 rounded-md">
	                        <i class="fas fa-calendar-alt"></i>
	                    </button>
	                    <button @click="setView('dayGridWeek')" :class="{'bg-blue-700': currentView === 'dayGridWeek'}" class="p-2 rounded-md">
	                        <i class="fas fa-calendar-week"></i>
	                    </button>
	                    <button @click="goToToday" class="p-2 rounded-md">
	                        <i class="fas fa-calendar-day"></i>
	                    </button>
	                </div>
	            </div>
	            <div class="flex items-center justify-between space-x-2">
	                <div class="flex items-center space-x-2">
	                    <button @click="navigate('prev')" class="p-2 rounded-full hover:bg-blue-700">
	                        <i class="fas fa-chevron-left"></i>
	                    </button>
	                    <h2 id="calendar-title" class="text-base md:text-lg font-semibold">
	                        {{ getTitle() }}
	                    </h2>
	                    <button @click="navigate('next')" class="p-2 rounded-full hover:bg-blue-700">
	                        <i class="fas fa-chevron-right"></i>
	                    </button>
	                </div>
	                <div class="hidden md:flex space-x-2 ml-4">
	                    <button @click="setView('dayGridMonth')" :class="{'bg-blue-70': currentView === 'dayGridMonth'}" class="px-3 py-1 rounded-md flex items-center" :disabled="disabledButtons.month">
	                        <i class="fas fa-calendar-alt mr-2"></i>
	                        <span>Mes</span>
	                    </button>
	                    <button @click="setView('dayGridWeek')" :class="{'bg-blue-700': currentView === 'dayGridWeek'}" class="px-3 py-1 rounded-md flex items-center" :disabled="disabledButtons.week">
	                        <i class="fas fa-calendar-week mr-2"></i>
	                        <span>Semana</span>
	                    </button>
	                    <button @click="goToToday" class="px-3 py-1 rounded-md flex items-center hover:bg-blue-700" :disabled="disabledButtons.today">
	                        <i class="fas fa-calendar-day mr-2"></i>
	                        <span>Hoy</span>
	                    </button>
			    <button @click="openPeriodoModal" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700" :disabled="disabledButtons.periodo" style="display:none;">
	                        <i class="fas fa-calendar mr-2"></i>
	                        <span>Periodo</span>
	                    </button>
	                    <button @click="toggleTimeline" :class="{'bg-blue-700': showTimeline}" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700" :disabled="disabledButtons.timeline" style="display:none;">
	                        <i class="fas fa-list-alt mr-2"></i>
	                        <span>Cronograma</span>
	                    </button>	
	                    <button @click="toggleVisorPDF" :class="{'bg-blue-700': showVisorPDF}" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700" :disabled="disabledButtons.visorPDF">
	                        <i class="fas fa-file-pdf mr-2"></i>
	                        <span>Visor PDF</span>
	                    </button>
	                    <button @click="openTercerosModal" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700" :disabled="disabledButtons.terceros">
	                        <i class="fas fa-users"></i>
	                    </button>
	                    <button @click="openProgrammingModal" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700" :disabled="disabledButtons.programming">
	                        <i class="fas fa-list"></i>
	                    </button>
	                    <button @click="toggleEventLimit" :disabled="currentView !== 'dayGridMonth' || disabledButtons.eventLimit" :class="{'bg-blue-700': limitEvents, 'bg-gray-400 cursor-not-allowed': currentView !== 'dayGridMonth'}" class="px-3 py-1 rounded-md flex items-center justify-center hover:bg-blue-700">
	                        <i :class="limitEvents ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
	                    </button>
	                </div>
	            </div>
	        </div>
	    </div>
	</header>
	<!-- ---------------------------------- -->
	<!-- End Component: Header -->
	<!-- ---------------------------------- -->

        <!-- ---------------------------------- -->
        <!-- Component: Calendar -->
        <!-- ---------------------------------- -->
        <div id="calendar" class="flex-1" v-show="!showTimeline"></div>
        <!-- ---------------------------------- -->
        <!-- End Component: Calendar -->
        <!-- ---------------------------------- -->

        <!-- ---------------------------------- -->
	<!-- Component: Event Modal -->
	<!-- ---------------------------------- -->
	<div v-if="showModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 modal">
		<div class="bg-white rounded-lg shadow-xl w-full max-w-lg mx-4">
			<div class="p-6">
				<div class="flex justify-between items-center mb-4">
					<h3 class="text-lg font-semibold text-gray-900">
						{{ currentEvent ? 'Editar Viático' : 'Nuevo Viático' }}
					</h3>
					<div class="flex items-center space-x-3">
						<div class="flex items-center">
							<label for="viatica" class="text-sm font-medium text-gray-700 mr-2">Viática</label>
							<input type="checkbox" id="viatica" v-model="form.viatica" class="h-6 w-6 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
						</div>
						<button @click="closeModal" class="text-gray-400 hover:text-gray-500">
							<i class="fas fa-times"></i>
						</button>
					</div>
				</div>
				<div v-if="error" class="mb-4 p-2 bg-red-100 text-red-700 rounded-md">
					{{ error }}
				</div>
				<form @submit.prevent="saveEvent">
					<div class="space-y-4">
						<div>
							<div class="relative">
								<input
									id="title"
									v-model="searchQuery"
									@focus="showOptions = true"
									@blur="hideOptions"
									@input="filterTerceros"
									placeholder="Selecciona un tercero..."
									class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
								>
								<div v-if="showOptions && filteredTerceros.length" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto">
									<div
										v-for="tercero in filteredTerceros"
										:key="tercero.id"
										class="px-3 py-2 hover:bg-gray-100 cursor-pointer"
										@mousedown="selectTercero(tercero)"
									>
										{{ tercero.nombreTercero }}
									</div>
								</div>
								<div v-else-if="showOptions" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg">
									<div class="px-3 py-2 text-gray-500">No se encontraron resultados</div>
								</div>
							</div>
							<input type="hidden" v-model="form.terceroId" name="terceroId" />
						</div>
						<div>
							<label for="description" class="block text-sm font-medium text-gray-700">Descripción de la comisión de servicios o salida de campo</label>
							<textarea
								id="description"
								v-model="form.description"
								@input="handleDescriptionInput"
								rows="3"
								maxlength="120"
								class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
							></textarea>
						</div>
						<div class="grid grid-cols-2 gap-4">
							<div class="relative">
								<label for="origen" class="block text-sm font-medium text-gray-700">Origen</label>
								<input
									id="origen"
									v-model="origenQuery"
									@focus="showOrigenOptions = true"
									@blur="hideOrigenOptions"
									@input="filterOrigenCities"
									placeholder="Selecciona una ciudad..."
									class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
								>
								<div v-if="showOrigenOptions && filteredOrigenCities.length" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto">
									<div
										v-for="city in filteredOrigenCities"
										:key="city.id"
										class="px-3 py-2 hover:bg-gray-100 cursor-pointer"
										@mousedown="selectOrigenCity(city)"
									>
										{{ city.nombreCiudad }}
									</div>
								</div>
								<div v-else-if="showOrigenOptions" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg">
									<div class="px-3 py-2 text-gray-500">No hay resultados</div>
								</div>
							</div>
							<div class="relative">
								<label for="destino" class="block text-sm font-medium text-gray-700">Destino</label>
								<input
									id="destino"
									v-model="destinoQuery"
									@focus="showDestinoOptions = true"
									@blur="hideDestinoOptions"
									@input="filterDestinoCities"
									placeholder="Selecciona una ciudad..."
									class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
								>
								<div v-if="showDestinoOptions && filteredDestinoCities.length" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto">
									<div
										v-for="city in filteredDestinoCities"
										:key="city.id"
										class="px-3 py-2 hover:bg-gray-100 cursor-pointer"
										@mousedown="selectDestinoCity(city)"
									>
										{{ city.nombreCiudad }}
									</div>
								</div>
								<div v-else-if="showDestinoOptions" class="absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg">
									<div class="px-3 py-2 text-gray-500">No hay resultados</div>
								</div>
							</div>
						</div>
						<div class="grid grid-cols-2 gap-4">
							<div>
								<label for="dateRange" class="block text-sm font-medium text-gray-700">Rango de Fechas *</label>
								<input type="text" id="dateRange" ref="dateRangePicker" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
							</div>
							<div>
								<label for="rutaAdicional" class="block text-sm font-medium text-gray-700">Ruta Adicional</label>
								<input
									type="text"
									id="rutaAdicional"
									v-model="form.rutaAdicional"
									@input="handleRutaAdicionalInput"
									class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
								>
							</div>
						</div>
						<div class="flex items-end gap-4">
							<div class="flex-1">
								<label for="transporte" class="block text-sm font-medium text-gray-700">Transporte</label>
								<input
									type="text"
									id="transporte"
									v-model="form.transporte"
									@input="handleTransporteInput"
									class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
								>
							</div>
							<div class="flex-1">
								<label for="color" class="block text-sm font-medium text-gray-700">Color</label>
								<select id="color" v-model="form.color" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
									<option value="#3b82f6">Azul</option>
									<option value="#10b981">Verde</option>
									<option value="#8b5cf6">Morado</option>
									<option value="#f59e0b">Amarillo</option>
									<option value="#ef4444">Rojo</option>
								</select>
							</div>
							<div class="flex space-x-3 items-end">
								<button v-if="currentEvent" type="button" @click="deleteEvent" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
									Eliminar
								</button>
								<button type="button" @click="closeModal" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
									Cancelar
								</button>
								<button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
									Guardar
								</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- ---------------------------------- -->
	<!-- End Component: Event Modal -->
	<!-- ---------------------------------- -->
		
        <!-- ---------------------------------- -->
        <!-- Component: Visor PDF -->
        <!-- ---------------------------------- -->
	<div v-if="isGeneratingPDF" class="loading-modal">
	    <div class="loading-spinner"></div>
	</div>
        <div id="visorPDF" class="flex-1" v-show="showVisorPDF">
            
                <!-- Generar PDF Button -->
		<button @click="generatePDF" class="generate-pdf-button">Generar PDF</button>
                <!-- Added hidden #outline element to satisfy theViewer -->
                <div id="outline" style="display: none;"></div>
                <div v-if="viaticos.length === 0" class="text-center visorPDF-white py-4">
                    No hay viáticos disponibles para mostrar. Por favor, genera la programación primero.
                </div>

		<div v-for="(viatico, index) in viaticos" :key="index" :id="'pf1-' + index" class="pf w0 h0" :data-page-no="index + 1">
		    <div class="pc pc1 w0 h0">
		        <img class="bi x0 y0 w1 h1" alt="" src="assets/bg1.png?v=1" />
		        <div class="c x1 y1 w2 h2">
		            <div class="t m0 x2 h3 y2 ff1 fs0 fc0 sc0 ls0 ws0">FORMATO DE AUTORIZACIÓN, SOLICITUD DE TRÁMITE Y AUTOLIQUIDACIÓN DE COMISIONES</div>
		            <div class="t m0 x2 h3 y3 ff1 fs0 fc0 sc0 ls0 ws0">DE SERVICIOS Y SALIDAS DE CAMPO AL INTERIOR DEL PAÍS DE CATEDRÁTICOS, DOCENTES</div>
		            <div class="t m0 x3 h3 y4 ff1 fs0 fc0 sc0 ls0 ws0">CAPACITADORES E INVESTIGADORES</div>
		        </div>
		        <div class="c x4 y5 w3 h4"><div class="t m0 x5 h3 y6 ff1 fs0 fc0 sc0 ls0 ws0">CODIGO: GF-FO-023</div></div>
		        <div class="c x4 y7 w3 h5"><div class="t m0 x5 h3 y8 ff1 fs0 fc0 sc0 ls0 ws0">VERSION: 04</div></div>
		        <div class="c x4 y1 w3 h4"><div class="t m0 x5 h3 y9 ff1 fs0 fc0 sc0 ls0 ws0">FECHA: 03/04/2025</div></div>
		        <div class="c x0 ya w4 h6"><div class="t m1 x6 h7 yb ff2 fs1 fc1 sc1 ls0 ws0">D i l i g e n c i e o s e l e c c i o n e ú n i c a m e n t e y a c o m p l e t i t u d l o s c a m p o s e n g r i s</div></div>
		        <div class="c x0 yc w5 h8"><div class="t m0 x5 h3 yd ff1 fs0 fc2 sc2 ls0 ws0">Dependencia solicitante:</div></div>
		        <div class="c x7 yc w6 h8"><div class="t m0 x8 h3 yd ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.dependencia || '' }}</div></div>
		        <div class="c x9 yc w7 h8"><div class="t m0 xa h3 yd ff1 fs0 fc2 sc2 ls0 ws0">FECHA DE AUTOLIQUIDACIÓN</div></div>
		        <div class="c x4 yc w3 h8"><div class="t m0 xb h3 yd ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.currentDate || '' }}</div></div>
		        <div class="c x0 ye w4 h9"><div class="t m0 x5 h3 yf ff1 fs0 fc2 sc2 ls0 ws0">1. DATOS DEL CATEDRÁTICO / INVESTIGADOR / DOCENTE CAPACITADOR</div></div>
		        <div class="c x0 y10 w5 ha"><div class="t m0 x5 h3 y11 ff1 fs0 fc2 sc2 ls0 ws0">Nombre completo</div></div>
		        <div class="c x7 y10 w8 ha"><div class="t m0 xc h3 y11 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.nombreTercero || '' }}</div></div>
		        <div class="c xd y10 w9 ha"><div class="t m0 xe h3 y11 ff1 fs0 fc2 sc2 ls0 ws0">Fecha de Nacimiento (dd/mm/aaaa)</div></div>
		        <div class="c xf y10 wa ha"><div class="t m0 x10 h3 y11 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.nacimiento || '' }}</div></div>
		        <div class="c x0 y12 w5 hb"><div class="t m0 x5 h3 y13 ff1 fs0 fc2 sc2 ls0 ws0">C.C. No.</div></div>
		        <div class="c x7 y12 wb hb"><div class="t m0 xc h3 y13 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.numeroDocumentoTercero || '' }}</div></div>
		        <div class="c x11 y12 wc hb"><div class="t m0 x5 h3 y13 ff1 fs0 fc2 sc2 ls0 ws0">Correo electrónico</div></div>
		        <div class="c x9 y12 wd hb"><div class="t m0 x3 hc y13 ff3 fs0 fc2 sc3 ls0 ws0">{{ viatico?.tercero?.correo || '' }}</div></div>
		        <div class="c x0 y14 w5 hd">
		            <div class="t m0 x5 h3 y15 ff1 fs0 fc2 sc2 ls0 ws0">Teléfono de contacto y/o</div>
		            <div class="t m0 x5 h3 y16 ff1 fs0 fc2 sc2 ls0 ws0">Celular</div>
		        </div>
		        <div class="c x7 y14 wb hd"><div class="t m0 x12 h3 y17 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.telefono || '' }}</div></div>
		        <div class="c x11 y14 wc hd"><div class="t m0 x5 h3 y17 ff1 fs0 fc2 sc2 ls0 ws0">Entidad Bancaria</div></div>
		        <div class="c x9 y14 wd hd"><div class="t m0 x13 he y17 ff4 fs0 fc2 sc3 ls0 ws0">{{ viatico?.tercero?.entidadBancaria || '' }}</div></div>
		        <div class="c x0 y18 w5 hb"><div class="t m0 x5 h3 y19 ff1 fs0 fc2 sc2 ls0 ws0">Rol ESAP:</div></div>
		        <div class="c x7 y18 w6 hb"><div class="t m0 x14 h3 y19 ff1 fs0 fc2 sc2 ls0 ws0">Docente catedrático - Capacitadores</div></div>
		        <div class="c x9 y18 we hb"><div class="t m0 x15 h3 y19 ff1 fs0 fc2 sc2 ls0 ws0">TIPO DE CUENTA:</div></div>
		        <div class="c xd y18 wf hb"><div class="t m0 x6 h3 y19 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.tipoCuenta || '' }}</div></div>
		        <div class="c x0 y1a w5 hf">
		            <div class="t m0 x5 h3 y1b ff1 fs0 fc2 sc2 ls0 ws0">Categoría docente</div>
		            <div class="t m0 x5 h3 y1c ff1 fs0 fc2 sc2 ls0 ws0">catedrático o investigador</div>
		        </div>
		        <div class="c x7 y1a w6 hf"><div class="t m0 x7 h3 y1d ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.tipoTercero || '' }}</div></div>
		        <div class="c x9 y1a we hf"><div class="t m0 x10 h3 y1d ff1 fs0 fc2 sc2 ls0 ws0">No. DE CUENTA:</div></div>
		        <div class="c xd y1a wf hf"><div class="t m0 x14 h3 y1d ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.tercero?.cuentaBancaria || '' }}</div></div>
		        <div class="c x0 y1e w4 h10"><div class="t m0 x5 h3 y1f ff1 fs0 fc2 sc2 ls0 ws0">2. DATOS DE LA COMISIÓN DE SERVICIOS O SALIDA DE CAMPO</div></div>
		        <div class="c x0 y20 w5 h11">
		            <div class="t m0 x16 h3 y21 ff1 fs0 fc2 sc2 ls0 ws0">Duración de la comisión de</div>
		            <div class="t m0 x16 h3 y22 ff1 fs0 fc2 sc2 ls0 ws0">servicios o salida de campo</div>
		            <div class="t m0 x17 h3 y23 ff1 fs0 fc2 sc2 ls0 ws0">en días:</div>
		        </div>
		        <div class="c x7 y20 w10 h11"><div class="t m0 x18 h3 y24 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.duracion || '' }}</div></div>
		        <div class="c x1 y25 w11 h12"><div class="t m0 x19 h3 y26 ff1 fs0 fc2 sc2 ls0 ws0">Fecha de inicio</div></div>
		        <div class="c x11 y25 wc h12"><div class="t m0 x17 hc y27 ff3 fs0 fc2 sc3 ls0 ws0">{{ viatico?.event?.startDate || '' }}</div></div>
		        <div class="c x9 y25 we h12">
		            <div class="t m0 x1a h3 y26 ff1 fs0 fc2 sc2 ls0 ws0">Hora de vuelo ida:</div>
		            <div class="t m0 xb h3 y28 ff1 fs0 fc2 sc2 ls0 ws0">(estimada</div>
		        </div>
		        <div class="c xd y25 w12 h12"><div class="t m0 xa hc y27 ff3 fs0 fc2 sc3 ls0 ws0">7:00</div></div>
		        <div class="c x4 y25 w3 h12"><div class="t m0 x1b h3 y27 ff1 fs0 fc2 sc2 ls0 ws0">Itinerario detallado:</div></div>
		        <div class="c x1 y20 w11 h13"><div class="t m0 x1c h3 y29 ff1 fs0 fc2 sc2 ls0 ws0">Fecha de finalización</div></div>
		        <div class="c x11 y20 wc h13"><div class="t m0 x1d hc y29 ff3 fs0 fc2 sc3 ls0 ws0">{{ viatico?.event?.endDate || '' }}</div></div>
		        <div class="c x9 y20 we h13">
		            <div class="t m0 x0 h3 y2a ff1 fs0 fc2 sc2 ls0 ws0">Hora de vuelo regreso:</div>
		            <div class="t m0 x1e h3 y2b ff1 fs0 fc2 sc2 ls0 ws0">(estimada)</div>
		        </div>
		        <div class="c xd y20 w12 h13"><div class="t m0 x19 hc y29 ff3 fs0 fc2 sc3 ls0 ws0">16:00</div></div>
		        <div class="c x4 y20 w3 h13"><div class="t m0 x0 h14 y2c ff3 fs2 fc3 sc3 ls0 ws0">{{ viatico?.event?.itinerario || '' }}</div></div>
		        <div class="c x0 y2d w5 h8"><div class="t m0 x5 h3 y2e ff1 fs0 fc2 sc2 ls0 ws0">Departamento</div></div>
		        <div class="c x7 y2d w6 h8"><div class="t m0 x1f h3 y2e ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.event?.ciudadDestinoDepartamento || '' }}</div></div>
		        <div class="c x9 y2d w7 h8"><div class="t m0 x20 h3 y2e ff1 fs0 fc2 sc2 ls0 ws0">Requiere tiquetes aéreos</div></div>
		        <div class="c x4 y2d w3 h8"><div class="t m0 x8 h3 y2e ff1 fs0 fc2 sc2 ls0 ws0">NO</div></div>
		        <div class="c x0 y2f w5 h15">
		            <div class="t m0 x5 h3 y30 ff1 fs0 fc2 sc2 ls0 ws0">Municipio / Isla / área no</div>
		            <div class="t m0 x5 h3 y31 ff1 fs0 fc2 sc2 ls0 ws0">municipalizada</div>
		        </div>
		        <div class="c x7 y2f w6 h15"><div class="t m0 x6 h3 y32 ff1 fs0 fc2 sc2 ls0 ws0">{{ viatico?.event?.ciudadDestino || '' }}</div></div>
		        <div class="c x9 y2f w7 h15"><div class="t m0 x21 h3 y32 ff1 fs0 fc2 sc2 ls0 ws0">Aeropuerto Destino</div></div>
		        <div class="c x4 y2f w3 h15"><div class="t m0 xa h3 y32 ff1 fs0 fc2 sc2 ls0 ws0">VALLE DEL CAUCA (Palmira)</div></div>
		        <div class="c x0 y33 w5 h16"><div class="t m0 x5 h3 y34 ff1 fs0 fc2 sc2 ls0 ws0">Objeto</div></div>
		        <div class="c x7 y33 w13 h16"><div class="t m0 x21 hc y34 ff3 fs0 fc2 sc3 ls0 ws0">{{ viatico?.event?.description || '' }}</div></div>
		        <div class="c x0 y35 w4 h8"><div class="t m0 x5 h3 y36 ff1 fs0 fc2 sc2 ls0 ws0">3. LIQUIDACIÓN DE LA COMISIÓN DE SERVICIOS O SALIDA DE CAMPO</div></div>
		        <div class="c x0 y37 w14 h17"><div class="t m0 x22 h3 y38 ff1 fs0 fc2 sc2 ls0 ws0">Descripción del día</div></div>
		        <div class="c x11 y37 wc h17"><div class="t m0 x18 h3 y38 ff1 fs0 fc2 sc2 ls0 ws0">No. de Días</div></div>
		        <div class="c x9 y37 w7 h17"><div class="t m0 x23 h3 y38 ff1 fs0 fc2 sc2 ls0 ws0">Viáticos Diario</div></div>
		        <div class="c x4 y37 w3 h17"><div class="t m0 x24 h3 y38 ff1 fs0 fc2 sc2 ls0 ws0">Total</div></div>
		        <div class="c x0 y39 w14 h17"><div class="t m0 x25 hc y3a ff3 fs0 fc2 sc3 ls0 ws0">Pernoctados</div></div>
		        <div class="c x11 y39 wc h17"><div class="t m0 x21 hc y3a ff3 fs0 fc2 sc3 ls0 ws0">1</div></div>
		        <div class="c x9 y39 w7 h17">
		            <div class="t m0 x5 hc y3a ff3 fs0 fc2 sc3 ls0 ws0">$ <span class="_ _0"> </span>293,886</div>
		        </div>
		        <div class="c x4 y39 w3 h17">
		            <div class="t m0 x5 hc y3a ff3 fs0 fc2 sc3 ls0 ws0">$ <span class="_ _1"> </span>293,886</div>
		        </div>
		        <div class="c x0 y3b w14 h17"><div class="t m0 x26 hc y3c ff3 fs0 fc2 sc3 ls0 ws0">No Pernoctados</div></div>
		        <div class="c x11 y3b wc h17"><div class="t m0 x21 hc y3c ff3 fs0 fc2 sc3 ls0 ws0">1</div></div>
		        <div class="c x9 y3b w7 h17">
		            <div class="t m0 x5 hc y3c ff3 fs0 fc2 sc3 ls0 ws0">$ <span class="_ _0"> </span>146,943</div>
		        </div>
		        <div class="c x4 y3b w3 h17">
		            <div class="t m0 x5 hc y3c ff3 fs0 fc2 sc3 ls0 ws0">$ <span class="_ _1"> </span>146,943</div>
		        </div>
		        <div class="c x0 y3d w15 h17"><div class="t m0 x27 h3 y3e ff1 fs0 fc2 sc2 ls0 ws0">Total Viáticos o auxilio económico de desplazamiento</div></div>
		        <div class="c x4 y3d w3 h17">
		            <div class="t m0 x5 h3 y3e ff1 fs0 fc2 sc2 ls0 ws0">$ <span class="_ _1"> </span>440,829</div>
		        </div>
		        <div class="c x0 y3f w4 h17"><div class="t m0 x5 h3 y40 ff1 fs0 fc2 sc2 ls0 ws0">4. LIQUIDACIÓN DE GASTOS DE TRANSPORTE Y/O AUXILIOS ECONÓMICOS DE DESPLAZAMIENTO</div></div>
		        <div class="c x0 y41 w14 h17"><div class="t m0 x28 h3 y42 ff1 fs0 fc2 sc2 ls0 ws0">Descripción</div></div>
		        <div class="c x11 y41 w16 h17"><div class="t m0 x29 h3 y42 ff1 fs0 fc2 sc2 ls0 ws0">Total</div></div>
		        <div class="c x0 y43 w14 h18">
		            <div class="t m0 x10 h3 y44 ff1 fs0 fc2 sc2 ls0 ws0">Total gastos de transporte / auxilios económicos de desplazamientos</div>
		            <div class="t m0 x2a h3 y45 ff1 fs0 fc2 sc2 ls0 ws0">terminales aéreos</div>
		        </div>
		        <div class="c x11 y43 w16 h18">
		            <div class="t m0 x5 h3 y46 ff1 fs0 fc2 sc2 ls0 ws0">$ <span class="_ _2"> </span>-</div>
		        </div>
		        <div class="c x0 y47 w14 h18"><div class="t m0 x16 h3 y48 ff1 fs0 fc2 sc2 ls0 ws0">Transporte y desplazamiento por vía terrestre, marítimo, fluvial y/o ferroviario</div></div>
		        <div class="c x11 y47 w16 h18">
		            <div class="t m0 x5 h3 y48 ff1 fs0 fc2 sc2 ls0 ws0">$ <span class="_ _3"> </span>{{ viatico?.event?.transporte || '' }}</div>
		        </div>
		        <div class="c x0 y49 w14 h18">
		            <div class="t m0 x1c h3 y4a ff1 fs0 fc2 sc2 ls0 ws0">TOTAL GASTOS DE TRANSPORTE Y/O AUXILIOS ECONÓMICOS DE</div>
		            <div class="t m0 x1f h3 y4b ff1 fs0 fc2 sc2 ls0 ws0">DESPLAZAMIENTO</div>
		        </div>
		        <div class="c x11 y49 w16 h18">
		            <div class="t m0 x5 h3 y4c ff1 fs0 fc2 sc2 ls0 ws0">$ <span class="_ _4"> </span>470,429</div>
		        </div>
		        <div class="c x0 y4d w4 h19"><div class="t m0 x5 h3 y4e ff1 fs0 fc2 sc2 ls0 ws0">5. INFORMACIÓN FINANCIERA DE LA COMISIÓN DE SERVICIOS O SALIDA DE CAMPO</div></div>
		        <div class="c x0 y4f w4 h1a">
		            <div class="t m0 x5 hc y50 ff3 fs0 fc2 sc3 ls0 ws0">
		                El pago de la presente comisión de servicios / autorización de desplazamiento, se hará con cargo a 0072DP - DECANATURA PREGRADO, del Rubro C-0503-1000-16-20203K0503014-02, según
		            </div>
		            <div class="t m0 x5 hc y51 ff3 fs0 fc2 sc3 ls0 ws0">Certificado de Disponibilidad Presupuestal No. 4325 del 04/02/2025</div>
		        </div>
		        <div class="c x0 y52 w5 h1b">
		            <div class="t m0 x5 hc y53 ff3 fs0 fc2 sc3 ls0 ws0">_________________________</div>
		            <div class="t m0 x5 hc y54 ff3 fs0 fc2 sc3 ls0 ws0">________________________</div>
		            <div class="t m0 x5 hc y55 ff3 fs0 fc2 sc3 ls0 ws0">_________________________</div>
		            <div class="t m0 x5 hc y56 ff3 fs0 fc2 sc3 ls0 ws0">_________________________</div>
		            <div class="t m0 x5 hc y57 ff3 fs0 fc2 sc3 ls0 ws0">____</div>
		            <div class="t m0 x5 hc y58 ff3 fs0 fc2 sc3 ls0 ws0">Firma Jefe de Dependencia</div>
		            <div class="t m0 x5 hc y59 ff3 fs0 fc2 sc3 ls0 ws0">Firma Gerente de Proyecto</div>
		        </div>
		        <div class="c x7 y5a wb h1c"><div class="t m0 x18 hc y5b ff3 fs0 fc2 sc3 ls0 ws0">Carmen Marlene Rojas Gallego</div></div>
		        <div class="c xd y5a w9 h1c"><div class="t m0 x0 hc y5b ff3 fs0 fc2 sc3 ls0 ws0">Yeimi Viviana Agudo Rodriguez</div></div>
		        <div class="c x0 y5c w17 h1d"><div class="t m0 x2b hc y5d ff3 fs0 fc2 sc3 ls0 ws0">Coordinadora Académica</div></div>
		        <div class="c x9 y5c wd h1d"><div class="t m0 x2c hc y5d ff3 fs0 fc2 sc3 ls0 ws0">Directora Territorial</div></div>
		        <div class="c x0 y5e w15 h1e"><div class="t m0 x5 h1f y5f ff3 fs3 fc2 sc3 ls0 ws0">Elaboró: Carmen Marlene Rojas, Profesional Especializado</div></div>
		        <div class="c x4 y60 w3 h20">
		            <div class="t m0 x0 h3 y61 ff1 fs0 fc2 sc2 ls0 ws0">La información recolectada en este</div>
		            <div class="t m0 xe h3 y62 ff1 fs0 fc2 sc2 ls0 ws0">documento es tratada bajo la política de</div>
		            <div class="t m0 x2d h3 y63 ff1 fs0 fc2 sc2 ls0 ws0">Datos Personales de la ESAP en</div>
		            <div class="t m0 x15 h3 y64 ff1 fs0 fc2 sc2 ls0 ws0">cumplimiento a la Ley1581de2012</div>
		        </div>
		        <div class="c x0 y65 w15 h21"><div class="t m0 x5 h1f y66 ff3 fs3 fc2 sc3 ls0 ws0">Revisó: Carmen Marlene Rojas, Profesional Especializado</div></div>
		        <div class="c x0 y60 w15 h22"><div class="t m0 x5 h1f y67 ff3 fs3 fc2 sc3 ls0 ws0">Aprobó: Yeimi Viviana Agudo, Directora Territorial</div></div>
		    </div>
		    <div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div>
		</div>

		<div id="pf2" class="pf w18 h23" data-page-no="2">
    <div class="pc pc2 w18 h23">
        <img class="bi x0 y0 w19 h24" alt="" src="assets/bg2.png?v=1" />
        <div class="c x2e y68 w1a h25">
            <div class="t m0 x2f h26 y69 ff1 fs4 fc0 sc0 ls0 ws0">FORMATO DE AUTORIZACIÓN SOLICITUD DE TRÁMITE Y LIQUIDACIÓN DE COMISIÓN DE</div>
            <div class="t m0 x5 h26 y6a ff1 fs4 fc0 sc0 ls0 ws0">SERVICIOS, GASTOS DE TRANSPORTE, GASTOS DE DESPLAZAMIENTO Y AUXILIO ECONÓMICO DE</div>
            <div class="t m0 x30 h26 y6b ff1 fs4 fc0 sc0 ls0 ws0">DESPLAZAMIENTO</div>
        </div>
        <div class="c x31 y6c w1b h27"><div class="t m0 x5 h26 y6d ff1 fs4 fc0 sc0 ls0 ws0">CODIGO: GF-FO-023</div></div>
        <div class="c x31 y6e w1b h28"><div class="t m0 x5 h26 y6f ff1 fs4 fc0 sc0 ls0 ws0">VERSION: 04</div></div>
        <div class="c x31 y68 w1b h27"><div class="t m0 x5 h26 y70 ff1 fs4 fc0 sc0 ls0 ws0">FECHA: 03/04/2025</div></div>
        <div class="c x0 y71 w1c h29"><div class="t m1 x32 h2a y72 ff2 fs5 fc1 sc1 ls0 ws0">D i l i g e n c i e o s e l e c c i o n e ú n i c a m e n t e y a c o m p l e t i t u d l o s c a m p o s e n g r i s</div></div>
        <div class="c x0 y73 w1d h2b"><div class="t m0 x5 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">Dependencia solicitante:</div></div>
        <div class="c x28 y73 w1e h2b"><div class="t m0 x14 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">0072DP - DECANATURA PREGRADO</div></div>
        <div class="c x33 y73 w1f h2b"><div class="t m0 x19 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">FECHA DE AUTOLIQUIDACIÓN</div></div>
        <div class="c x31 y73 w1b h2b"><div class="t m0 xb h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">5/5/2025</div></div>
        <div class="c x0 y75 w1c h2c"><div class="t m0 x5 h26 y76 ff1 fs4 fc2 sc2 ls0 ws0">1. DATOS DEL COMISIONADO (SERVIDOR, DOCENTE DE PLANTA, DOCENTE OCASIONAL, DOCENTE ESPECIAL, DOCENTE VISITANTE) O ESTUDIANTE</div></div>
        <div class="c x0 y77 w1d h2d"><div class="t m0 x5 h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">Nombre completo</div></div>
        <div class="c x28 y77 w20 h2d"><div class="t m0 x7 h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">JUAN CARLOS QUINTERO CALVACHE</div></div>
        <div class="c x34 y77 w21 h2d"><div class="t m0 xe h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">Fecha de Nacimiento (dd/mm/aaaa)</div></div>
        <div class="c xf y77 w22 h2d"><div class="t m0 x10 h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">11/10/1996</div></div>
        <div class="c x0 y79 w1d h2d"><div class="t m0 x5 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">C.C. No.</div></div>
        <div class="c x28 y79 w23 h2d"><div class="t m0 x35 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">16,791,253</div></div>
        <div class="c x36 y79 w24 h2d"><div class="t m0 x5 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">Cargo / Rol ESAP</div></div>
        <div class="c x33 y79 w25 h2d"><div class="t m0 x37 h2e y7a ff3 fs4 fc2 sc3 ls0 ws0">CARRERA</div></div>
        <div class="c x0 y7b w1d h2d">
            <div class="t m0 x5 h26 y7c ff1 fs4 fc2 sc2 ls0 ws0">Teléfono de contacto y/o</div>
            <div class="t m0 x5 h26 y7d ff1 fs4 fc2 sc2 ls0 ws0">Celular:</div>
        </div>
        <div class="c x28 y7b w23 h2d"><div class="t m0 x8 h26 y7e ff1 fs4 fc2 sc2 ls0 ws0">3103732839</div></div>
        <div class="c x36 y7b w24 h2d">
            <div class="t m0 x5 h26 y7c ff1 fs4 fc2 sc2 ls0 ws0">Correo Electrónico</div>
            <div class="t m0 x5 h26 y7d ff1 fs4 fc2 sc2 ls0 ws0">Institucional:</div>
        </div>
        <div class="c x33 y7b w25 h2d"><div class="t m0 x2a h2f y7e ff4 fs4 fc2 sc3 ls0 ws0">juan.quinteroc@esap.edu.co</div></div>
        <div class="c x0 y7f w1d h30"><div class="t m0 x5 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">Entidad Bancaria</div></div>
        <div class="c x28 y7f w1e h30"><div class="t m0 x32 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">BANCO DAVIVIENDA S.A.</div></div>
        <div class="c x33 y7f w26 h30"><div class="t m0 x2d h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">Tipo de Cuenta:</div></div>
        <div class="c x34 y7f w27 h30"><div class="t m0 x6 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">AHORRO</div></div>
        <div class="c x0 y81 w1d h31">
            <div class="t m0 x5 h26 y82 ff1 fs4 fc2 sc2 ls0 ws0">Asignación básica mensual:</div>
            <div class="t m0 x5 h2e y83 ff3 fs4 fc2 sc3 ls0 ws0">(Nota: para estudiantes</div>
            <div class="t m0 x5 h2e y84 ff3 fs4 fc2 sc3 ls0 ws0">registrar el salario mínimo)</div>
        </div>
        <div class="c x28 y81 w1e h31">
            <div class="t m0 x5 h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _5"> </span>12,502,106</div>
        </div>
        <div class="c x33 y81 w26 h31"><div class="t m0 x2f h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">No. de Cuenta:</div></div>
        <div class="c x34 y81 w27 h31"><div class="t m0 x38 h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">016570281150</div></div>
        <div class="c x0 y86 w1c h32"><div class="t m0 x5 h26 y87 ff1 fs4 fc2 sc2 ls0 ws0">2. DATOS DE LA COMISIÓN DE SERVICIOS O AUTORIZACIÓN DE DESPLAZAMIENTO</div></div>
        <div class="c x0 y88 w1d h33"><div class="t m0 x0 h26 y89 ff1 fs4 fc2 sc2 ls0 ws0">Duración (en días):</div></div>
        <div class="c x28 y88 w28 h33"><div class="t m0 x18 h26 y89 ff1 fs4 fc2 sc2 ls0 ws0">0.5</div></div>
        <div class="c x2e y8a w29 h34"><div class="t m0 x18 h26 y8b ff1 fs4 fc2 sc2 ls0 ws0">Fecha de inicio</div></div>
        <div class="c x36 y8a w24 h34"><div class="t m0 x1a h2e y8b ff3 fs4 fc2 sc3 ls0 ws0">5/9/2025</div></div>
        <div class="c x33 y8a w26 h34">
            <div class="t m0 x18 h26 y8c ff1 fs4 fc2 sc2 ls0 ws0">Hora de vuelo ida:</div>
            <div class="t m0 x23 h26 y8d ff1 fs4 fc2 sc2 ls0 ws0">(estimada)</div>
        </div>
        <div class="c x31 y8a w1b h34"><div class="t m0 x39 h26 y8b ff1 fs4 fc2 sc2 ls0 ws0">Itinerario (detallado):</div></div>
        <div class="c x2e y88 w29 h35"><div class="t m0 x2d h26 y8e ff1 fs4 fc2 sc2 ls0 ws0">Fecha de finalización</div></div>
        <div class="c x36 y88 w24 h35"><div class="t m0 x1a h2e y8e ff3 fs4 fc2 sc3 ls0 ws0">5/9/2025</div></div>
        <div class="c x33 y88 w26 h35">
            <div class="t m0 x15 h26 y8f ff1 fs4 fc2 sc2 ls0 ws0">Hora de vuelo regreso:</div>
            <div class="t m0 x23 h26 y90 ff1 fs4 fc2 sc2 ls0 ws0">(estimada)</div>
        </div>
        <div class="c x31 y88 w1b h35"><div class="t m0 x0 h36 y91 ff3 fs6 fc2 sc3 ls0 ws0">CALI-GUADALAJARA DE BUGA-CALI</div></div>
        <div class="c x0 y92 w1d h37"><div class="t m0 x5 h26 y93 ff1 fs4 fc2 sc2 ls0 ws0">Objeto</div></div>
        <div class="c x28 y92 w2a h37"><div class="t m0 x3a h2e y93 ff3 fs4 fc2 sc3 ls0 ws0">DICTAR ASIGNATURA DE REGIMEN DEL SERVIDOR PUBLICO EN EL CENTRO DE TUTORIA DE GUADALAJARA DE BUGA EL 09-05-2025</div></div>
        <div class="c x0 y94 w1d h38">
            <div class="t m0 x5 h26 y95 ff1 fs4 fc2 sc2 ls0 ws0">Destino Comisión /</div>
            <div class="t m0 x5 h26 y96 ff1 fs4 fc2 sc2 ls0 ws0">Autorización de</div>
            <div class="t m0 x5 h26 y97 ff1 fs4 fc2 sc2 ls0 ws0">desplazamiento</div>
        </div>
        <div class="c x28 y94 w1e h38"><div class="t m0 x3b h26 y98 ff1 fs4 fc2 sc2 ls0 ws0">COLOMBIA</div></div>
        <div class="c x33 y94 w1f h38"><div class="t m0 x3c h26 y98 ff1 fs4 fc2 sc2 ls0 ws0">Ciudad de origen</div></div>
        <div class="c x31 y94 w1b h38"><div class="t m0 x24 h2e y98 ff3 fs4 fc2 sc3 ls0 ws0">CALI</div></div>
        <div class="c x0 y99 w1d h39">
            <div class="t m0 x5 h3a y9a ff1 fs7 fc2 sc2 ls0 ws0">TRM del día de diligenciamiento de</div>
            <div class="t m0 x5 h3a y9b ff1 fs7 fc2 sc2 ls0 ws0">este formato, sólo para comisiones</div>
            <div class="t m0 x15 h3a y9c ff1 fs7 fc2 sc2 ls0 ws0">de servicios en el exterior</div>
        </div>
        <div class="c x33 y99 w1f h39"><div class="t m0 x3d h26 y9d ff1 fs4 fc2 sc2 ls0 ws0">Aeropuerto Destino</div></div>
        <div class="c x31 y99 w1b h39"><div class="t m0 x3e h26 y9d ff1 fs4 fc2 sc2 ls0 ws0">Terrestre</div></div>
        <div class="c x0 y9e w1c h2b"><div class="t m0 x5 h26 y9f ff1 fs4 fc2 sc2 ls0 ws0">3. LIQUIDACIÓN DE LA COMISIÓN DE SERVICIOS O AUTORIZACIÓN DE DESPLAZAMIENTO</div></div>
        <div class="c x0 ya0 w2b h3b"><div class="t m0 x26 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Descripción del día</div></div>
        <div class="c x36 ya0 w24 h3b"><div class="t m0 x3f h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">No. de Días</div></div>
        <div class="c x33 ya0 w1f h3b"><div class="t m0 x40 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Viáticos Diario</div></div>
        <div class="c x31 ya0 w1b h3b"><div class="t m0 x24 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Total</div></div>
        <div class="c x0 ya2 w2b h3c"><div class="t m0 x3b h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">Pernoctados</div></div>
        <div class="c x36 ya2 w24 h3c"><div class="t m0 x3d h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">0</div></div>
        <div class="c x33 ya2 w1f h3c">
            <div class="t m0 x5 h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _6"> </span>622,374.00</div>
        </div>
        <div class="c x31 ya2 w1b h3c">
            <div class="t m0 x5 h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _7"> </span>-</div>
        </div>
        <div class="c x0 ya4 w2b h3c"><div class="t m0 x25 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">No Pernoctados</div></div>
        <div class="c x36 ya4 w24 h3c"><div class="t m0 x3d h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">1</div></div>
        <div class="c x33 ya4 w1f h3c">
            <div class="t m0 x5 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _6"> </span>311,187.00</div>
        </div>
        <div class="c x31 ya4 w1b h3c">
            <div class="t m0 x5 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _8"> </span>311,187.00</div>
        </div>
        <div class="c x0 ya6 w2c h3c"><div class="t m0 x41 h26 ya7 ff1 fs4 fc2 sc2 ls0 ws0">Total Viáticos</div></div>
        <div class="c x31 ya6 w1b h3c">
            <div class="t m0 x5 h26 ya7 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _8"> </span>311,187.00</div>
        </div>
        <div class="c x0 ya8 w1c h3b"><div class="t m0 x5 h26 ya9 ff1 fs4 fc2 sc2 ls0 ws0">4. LIQUIDACIÓN DE LOS GASTOS DE DESPLAZAMIENTO</div></div>
        <div class="c x0 yaa w2b h3c"><div class="t m0 x42 h26 yab ff1 fs4 fc2 sc2 ls0 ws0">Descripción</div></div>
        <div class="c x36 yaa w2d h3c"><div class="t m0 x43 h26 yab ff1 fs4 fc2 sc2 ls0 ws0">Total</div></div>
        <div class="c x0 yac w2b h3b"><div class="t m0 x3c h26 yad ff1 fs4 fc2 sc2 ls0 ws0">Total Transporte y desplazamientos terminales aéreos</div></div>
        <div class="c x36 yac w2d h3b">
            <div class="t m0 x5 h26 yad ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _9"> </span>-</div>
        </div>
        <div class="c x0 yae w2b h3c"><div class="t m0 x1c h26 yaf ff1 fs4 fc2 sc2 ls0 ws0">Transporte y desplazamiento por vía terrestre, marítimo, fluvial y/o ferroviario</div></div>
        <div class="c x36 yae w2d h3c">
            <div class="t m0 x5 h26 yaf ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _a"> </span>29,600.00</div>
        </div>
        <div class="c x0 yb0 w2b h3c"><div class="t m0 x17 h26 yb1 ff1 fs4 fc2 sc2 ls0 ws0">TOTAL VIÁTICOS, TRANSPORTES Y DESPLAZAMIENTOS*</div></div>
        <div class="c x36 yb0 w2d h3c">
            <div class="t m0 x5 h26 yb1 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _b"> </span>340,787.00</div>
        </div>
        <div class="c x0 yb2 w1c h3c">
            <div class="t m0 x5 h26 yb3 ff1 fs4 fc2 sc2 ls0 ws0">*NOTA<span class="ff3 sc3">: Para la liquidación de gastos de transporte se aplicará lo referido en la Resolución de viáticos vigente.</span></div>
        </div>
        <div class="c x0 yb4 w1c h3d"><div class="t m0 x5 h26 yb5 ff1 fs4 fc2 sc2 ls0 ws0">5. INFORMACIÓN FINANCIERA DE LA COMISIÓN DE SERVICIOS O AUTORIZACIÓN DE DESPLAZAMIENTO</div></div>
        <div class="c x0 yb6 w1c h3e">
            <div class="t m0 x5 h2e yb7 ff3 fs4 fc2 sc3 ls0 ws0">
                El pago de la presente comisión de servicios / autorización de desplazamiento, se hará con cargo a 0072DP - DECANATURA PREGRADO, del Rubro C-0503-1000-16-20203K0503014-02, según
            </div>
            <div class="t m0 x5 h2e yb8 ff3 fs4 fc2 sc3 ls0 ws0">Certificado de Disponibilidad Presupuestal No. 4325 del 04/02/2025</div>
        </div>
        <div class="c x0 yb9 w1d h3f">
            <div class="t m0 x5 h2e yba ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybb ff3 fs4 fc2 sc3 ls0 ws0">________________________</div>
            <div class="t m0 x5 h2e ybc ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybd ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybe ff3 fs4 fc2 sc3 ls0 ws0">____</div>
            <div class="t m0 x5 h2e ybf ff3 fs4 fc2 sc3 ls0 ws0">Firma Jefe de Dependencia</div>
            <div class="t m0 x5 h2e yc0 ff3 fs4 fc2 sc3 ls0 ws0">Firma Gerente de Proyecto</div>
        </div>
        <div class="c x28 yc1 w23 h40"><div class="t m0 x20 h2e yc2 ff3 fs4 fc2 sc3 ls0 ws0">Carmen Marlene Rojas Gallego</div></div>
        <div class="c x34 yc1 w21 h40"><div class="t m0 x15 h2e yc2 ff3 fs4 fc2 sc3 ls0 ws0">Yeimi Viviana Agudo Rodriguez</div></div>
        <div class="c x0 yc3 w2e h41"><div class="t m0 x44 h2e yc4 ff3 fs4 fc2 sc3 ls0 ws0">Coordinadora Académica</div></div>
        <div class="c x33 yc3 w25 h41"><div class="t m0 x42 h2e yc4 ff3 fs4 fc2 sc3 ls0 ws0">Directora Territorial</div></div>
        <div class="c x0 yc5 w2c h42"><div class="t m0 x5 h43 yc6 ff3 fs8 fc2 sc3 ls0 ws0">Elaboró: Carmen Marlene Rojas, Profesional Especializado</div></div>
        <div class="c x31 yc7 w1b h44">
            <div class="t m0 x0 h26 yc8 ff1 fs4 fc2 sc2 ls0 ws0">La información recolectada en este</div>
            <div class="t m0 xe h26 yc9 ff1 fs4 fc2 sc2 ls0 ws0">documento es tratada bajo la política de</div>
            <div class="t m0 x10 h26 yca ff1 fs4 fc2 sc2 ls0 ws0">Datos Personales de la ESAP en</div>
            <div class="t m0 x15 h26 ycb ff1 fs4 fc2 sc2 ls0 ws0">cumplimiento a la Ley 1581 de 2012</div>
        </div>
        <div class="c x0 ycc w2c h42"><div class="t m0 x5 h43 ycd ff3 fs8 fc2 sc3 ls0 ws0">Revisó: Carmen Marlene Rojas, Profesional Especializado</div></div>
        <div class="c x0 yc7 w2c h42"><div class="t m0 x5 h43 yce ff3 fs8 fc2 sc3 ls0 ws0">Aprobó: Yeimi Viviana Agudo, Directora Territorial</div></div>
    </div>
    <div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div>
</div>

		<div id="pf3" class="pf w18 h23" data-page-no="3">
    <div class="pc pc3 w18 h23">
        <img class="bi x0 y0 w19 h24" alt="" src="assets/bg3.png?v=1" />
        <div class="c x2e y68 w1a h25">
            <div class="t m0 x2f h26 y69 ff1 fs4 fc0 sc0 ls0 ws0">FORMATO DE AUTORIZACIÓN SOLICITUD DE TRÁMITE Y LIQUIDACIÓN DE COMISIÓN DE</div>
            <div class="t m0 x5 h26 y6a ff1 fs4 fc0 sc0 ls0 ws0">SERVICIOS, GASTOS DE TRANSPORTE, GASTOS DE DESPLAZAMIENTO Y AUXILIO ECONÓMICO DE</div>
            <div class="t m0 x30 h26 y6b ff1 fs4 fc0 sc0 ls0 ws0">DESPLAZAMIENTO</div>
        </div>
        <div class="c x31 y6c w1b h27"><div class="t m0 x5 h26 y6d ff1 fs4 fc0 sc0 ls0 ws0">CODIGO: GF-FO-023</div></div>
        <div class="c x31 y6e w1b h28"><div class="t m0 x5 h26 y6f ff1 fs4 fc0 sc0 ls0 ws0">VERSION: 04</div></div>
        <div class="c x31 y68 w1b h27"><div class="t m0 x5 h26 y70 ff1 fs4 fc0 sc0 ls0 ws0">FECHA: 03/04/2025</div></div>
        <div class="c x0 y71 w1c h29"><div class="t m1 x32 h2a y72 ff2 fs5 fc1 sc1 ls0 ws0">D i l i g e n c i e o s e l e c c i o n e ú n i c a m e n t e y a c o m p l e t i t u d l o s c a m p o s e n g r i s</div></div>
        <div class="c x0 y73 w1d h2b"><div class="t m0 x5 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">Dependencia solicitante:</div></div>
        <div class="c x28 y73 w1e h2b"><div class="t m0 x14 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">0072DP - DECANATURA PREGRADO</div></div>
        <div class="c x33 y73 w1f h2b"><div class="t m0 x19 h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">FECHA DE AUTOLIQUIDACIÓN</div></div>
        <div class="c x31 y73 w1b h2b"><div class="t m0 x3e h26 y74 ff1 fs4 fc2 sc2 ls0 ws0">5/5/2025</div></div>
        <div class="c x0 y75 w1c h2c"><div class="t m0 x5 h26 y76 ff1 fs4 fc2 sc2 ls0 ws0">1. DATOS DEL CONTRATISTA</div></div>
        <div class="c x0 y77 w1d h2d"><div class="t m0 x5 h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">Nombre completo</div></div>
        <div class="c x28 y77 w20 h2d"><div class="t m0 x2c h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">LINA MAYERLIN TABORDA OTERO</div></div>
        <div class="c x34 y77 w21 h2d"><div class="t m0 xe h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">Fecha de Nacimiento (dd/mm/aaaa)</div></div>
        <div class="c xf y77 w22 h2d"><div class="t m0 x10 h26 y78 ff1 fs4 fc2 sc2 ls0 ws0">11/10/1996</div></div>
        <div class="c x0 y79 w1d h2d"><div class="t m0 x5 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">C.C. No.</div></div>
        <div class="c x28 y79 w23 h2d"><div class="t m0 x45 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">1,107,103,852</div></div>
        <div class="c x36 y79 w24 h2d"><div class="t m0 x5 h26 y7a ff1 fs4 fc2 sc2 ls0 ws0">No. Contrato</div></div>
        <div class="c x33 y79 w25 h2d"><div class="t m0 x45 h2e y7a ff3 fs4 fc2 sc3 ls0 ws0">VAC-002-2025</div></div>
        <div class="c x0 y7b w1d h2d">
            <div class="t m0 x5 h26 y7c ff1 fs4 fc2 sc2 ls0 ws0">Teléfono de contacto y/o</div>
            <div class="t m0 x5 h26 y7d ff1 fs4 fc2 sc2 ls0 ws0">Celular:</div>
        </div>
        <div class="c x28 y7b w23 h2d"><div class="t m0 x8 h26 y7e ff1 fs4 fc2 sc2 ls0 ws0">3175695808</div></div>
        <div class="c x36 y7b w24 h2d">
            <div class="t m0 x5 h26 y7c ff1 fs4 fc2 sc2 ls0 ws0">Correo Electrónico</div>
            <div class="t m0 x5 h26 y7d ff1 fs4 fc2 sc2 ls0 ws0">Institucional:</div>
        </div>
        <div class="c x33 y7b w25 h2d"><div class="t m0 x3 h2f y7e ff4 fs4 fc2 sc3 ls0 ws0">lina.taborda@esap.edu.co</div></div>
        <div class="c x0 y7f w1d h30"><div class="t m0 x5 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">Entidad Bancaria</div></div>
        <div class="c x28 y7f w1e h30"><div class="t m0 x26 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">BANCO BOGOTA</div></div>
        <div class="c x33 y7f w26 h30"><div class="t m0 x2d h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">Tipo de Cuenta:</div></div>
        <div class="c x34 y7f w27 h30"><div class="t m0 x6 h26 y80 ff1 fs4 fc2 sc2 ls0 ws0">AHORRO</div></div>
        <div class="c x0 y81 w1d h31"><div class="t m0 x5 h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">Valor honorarios:</div></div>
        <div class="c x28 y81 w1e h31">
            <div class="t m0 x5 h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _c"> </span>3,700,000</div>
        </div>
        <div class="c x33 y81 w26 h31"><div class="t m0 x2f h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">No. de Cuenta:</div></div>
        <div class="c x34 y81 w27 h31"><div class="t m0 x46 h26 y85 ff1 fs4 fc2 sc2 ls0 ws0">347090771</div></div>
        <div class="c x0 y86 w1c h32"><div class="t m0 x5 h26 y87 ff1 fs4 fc2 sc2 ls0 ws0">2. DATOS AUTORIZACIÓN DE DESPLAZAMIENTO Y GASTOS DE DESPLAZAMIENTO</div></div>
        <div class="c x0 y88 w1d h33"><div class="t m0 x0 h26 y89 ff1 fs4 fc2 sc2 ls0 ws0">Duración (en días):</div></div>
        <div class="c x28 y88 w28 h33"><div class="t m0 x18 h26 y89 ff1 fs4 fc2 sc2 ls0 ws0">2.5</div></div>
        <div class="c x2e y8a w29 h34"><div class="t m0 x18 h26 y8b ff1 fs4 fc2 sc2 ls0 ws0">Fecha de inicio</div></div>
        <div class="c x36 y8a w24 h34"><div class="t m0 x1a h2e y8b ff3 fs4 fc2 sc3 ls0 ws0">5/9/2025</div></div>
        <div class="c x33 y8a w26 h34">
            <div class="t m0 x18 h26 y8c ff1 fs4 fc2 sc2 ls0 ws0">Hora de vuelo ida:</div>
            <div class="t m0 x23 h26 y8d ff1 fs4 fc2 sc2 ls0 ws0">(estimada)</div>
        </div>
        <div class="c x31 y8a w1b h34"><div class="t m0 x39 h26 y8b ff1 fs4 fc2 sc2 ls0 ws0">Itinerario (detallado):</div></div>
        <div class="c x2e y88 w29 h35"><div class="t m0 x2d h26 y8e ff1 fs4 fc2 sc2 ls0 ws0">Fecha de finalización</div></div>
        <div class="c x36 y88 w24 h35"><div class="t m0 x18 h2e y8e ff3 fs4 fc2 sc3 ls0 ws0">5/11/2025</div></div>
        <div class="c x33 y88 w26 h35">
            <div class="t m0 x15 h26 y8f ff1 fs4 fc2 sc2 ls0 ws0">Hora de vuelo regreso:</div>
            <div class="t m0 x23 h26 y90 ff1 fs4 fc2 sc2 ls0 ws0">(estimada)</div>
        </div>
        <div class="c x31 y88 w1b h35"><div class="t m0 x47 h36 y91 ff3 fs6 fc2 sc3 ls0 ws0">CALI-CARTAGO-SEVILLA-CALI</div></div>
        <div class="c x0 y92 w1d h37"><div class="t m0 x5 h26 y93 ff1 fs4 fc2 sc2 ls0 ws0">Objeto</div></div>
        <div class="c x28 y92 w2a h37"><div class="t m0 x3a h2e y93 ff3 fs4 fc2 sc3 ls0 ws0">DICTAR ASIGNATURA DE REGIMEN DEL SERVIDOR PUBLICO EN EL CENTRO DE TUTORIA DE GUADALAJARA DE BUGA EL 09-05-2025</div></div>
        <div class="c x0 y94 w1d h38">
            <div class="t m0 x5 h26 ycf ff1 fs4 fc2 sc2 ls0 ws0">Destino/ Autorización de</div>
            <div class="t m0 x5 h26 yd0 ff1 fs4 fc2 sc2 ls0 ws0">desplazamiento</div>
        </div>
        <div class="c x28 y94 w1e h38"><div class="t m0 x3b h26 y98 ff1 fs4 fc2 sc2 ls0 ws0">COLOMBIA</div></div>
        <div class="c x33 y94 w1f h38"><div class="t m0 x3c h26 y98 ff1 fs4 fc2 sc2 ls0 ws0">Ciudad de origen</div></div>
        <div class="c x31 y94 w1b h38"><div class="t m0 x24 h2e y98 ff3 fs4 fc2 sc3 ls0 ws0">CALI</div></div>
        <div class="c x0 y99 w1d h39">
            <div class="t m0 x5 h3a y9a ff1 fs7 fc2 sc2 ls0 ws0">TRM del día de diligenciamiento de</div>
            <div class="t m0 x5 h3a y9b ff1 fs7 fc2 sc2 ls0 ws0">este formato, sólo para comisiones</div>
            <div class="t m0 x15 h3a y9c ff1 fs7 fc2 sc2 ls0 ws0">de servicios en el exterior</div>
        </div>
        <div class="c x33 y99 w1f h39"><div class="t m0 x3d h26 y9d ff1 fs4 fc2 sc2 ls0 ws0">Aeropuerto Destino</div></div>
        <div class="c x31 y99 w1b h39"><div class="t m0 x3e h26 y9d ff1 fs4 fc2 sc2 ls0 ws0">Terrestre</div></div>
        <div class="c x0 y9e w1c h2b"><div class="t m0 x5 h26 y9f ff1 fs4 fc2 sc2 ls0 ws0">3. LIQUIDACIÓN DE LA AUTORIZACIÓN DE DESPLAZAMIENTO</div></div>
        <div class="c x0 ya0 w2b h3b"><div class="t m0 x26 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Descripción del día</div></div>
        <div class="c x36 ya0 w24 h3b"><div class="t m0 x3f h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">No. de Días</div></div>
        <div class="c x33 ya0 w1f h3b"><div class="t m0 x40 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Viáticos Diario</div></div>
        <div class="c x31 ya0 w1b h3b"><div class="t m0 x24 h26 ya1 ff1 fs4 fc2 sc2 ls0 ws0">Total</div></div>
        <div class="c x0 ya2 w2b h3c"><div class="t m0 x3b h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">Pernoctados</div></div>
        <div class="c x36 ya2 w24 h3c"><div class="t m0 x3d h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">2</div></div>
        <div class="c x33 ya2 w1f h3c">
            <div class="t m0 x5 h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _6"> </span>234,445.00</div>
        </div>
        <div class="c x31 ya2 w1b h3c">
            <div class="t m0 x5 h2e ya3 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _8"> </span>468,890.00</div>
        </div>
        <div class="c x0 ya4 w2b h3c"><div class="t m0 x25 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">No Pernoctados</div></div>
        <div class="c x36 ya4 w24 h3c"><div class="t m0 x3d h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">1</div></div>
        <div class="c x33 ya4 w1f h3c">
            <div class="t m0 x5 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _6"> </span>117,223.00</div>
        </div>
        <div class="c x31 ya4 w1b h3c">
            <div class="t m0 x5 h2e ya5 ff3 fs4 fc2 sc3 ls0 ws0">$ <span class="_ _8"> </span>117,223.00</div>
        </div>
        <div class="c x0 ya6 w2c h3c"><div class="t m0 x41 h26 ya7 ff1 fs4 fc2 sc2 ls0 ws0">Total Viáticos</div></div>
        <div class="c x31 ya6 w1b h3c">
            <div class="t m0 x5 h26 ya7 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _8"> </span>586,113.00</div>
        </div>
        <div class="c x0 ya8 w1c h3b"><div class="t m0 x5 h26 ya9 ff1 fs4 fc2 sc2 ls0 ws0">4. LIQUIDACIÓN DE LOS GASTOS DE DESPLAZAMIENTO</div></div>
        <div class="c x0 yaa w2b h3c"><div class="t m0 x42 h26 yab ff1 fs4 fc2 sc2 ls0 ws0">Descripción</div></div>
        <div class="c x36 yaa w2d h3c"><div class="t m0 x43 h26 yab ff1 fs4 fc2 sc2 ls0 ws0">Total</div></div>
        <div class="c x0 yac w2b h3b"><div class="t m0 x3c h26 yad ff1 fs4 fc2 sc2 ls0 ws0">Total Transporte y desplazamientos terminales aéreos</div></div>
        <div class="c x36 yac w2d h3b">
            <div class="t m0 x5 h26 yad ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _9"> </span>-</div>
        </div>
        <div class="c x0 yae w2b h3c"><div class="t m0 x1c h26 yaf ff1 fs4 fc2 sc2 ls0 ws0">Transporte y desplazamiento por vía terrestre, marítimo, fluvial y/o ferroviario</div></div>
        <div class="c x36 yae w2d h3c">
            <div class="t m0 x5 h26 yaf ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _b"> </span>130,000.00</div>
        </div>
        <div class="c x0 yb0 w2b h3c"><div class="t m0 x17 h26 yb1 ff1 fs4 fc2 sc2 ls0 ws0">TOTAL VIÁTICOS, TRANSPORTES Y DESPLAZAMIENTOS*</div></div>
        <div class="c x36 yb0 w2d h3c">
            <div class="t m0 x5 h26 yb1 ff1 fs4 fc2 sc2 ls0 ws0">$ <span class="_ _b"> </span>716,113.00</div>
        </div>
        <div class="c x0 yb2 w1c h3c">
            <div class="t m0 x5 h26 yb3 ff1 fs4 fc2 sc2 ls0 ws0">*NOTA<span class="ff3 sc3">: Para la liquidación de gastos de transporte se aplicará lo referido en la Resolución de viáticos vigente.</span></div>
        </div>
        <div class="c x0 yb4 w1c h3d"><div class="t m0 x5 h26 yb5 ff1 fs4 fc2 sc2 ls0 ws0">5. INFORMACIÓN FINANCIERA DE LA COMISIÓN DE SERVICIOS O AUTORIZACIÓN DE DESPLAZAMIENTO</div></div>
        <div class="c x0 yb6 w1c h3e">
            <div class="t m0 x5 h2e yb7 ff3 fs4 fc2 sc3 ls0 ws0">
                El pago de la presente comisión de servicios / autorización de desplazamiento, se hará con cargo a 0072DP - DECANATURA PREGRADO, del Rubro 0, según Certificado de Disponibilidad Presupuestal
            </div>
            <div class="t m0 x5 h2e yb8 ff3 fs4 fc2 sc3 ls0 ws0">No. 4325 del 04/02/2025</div>
        </div>
        <div class="c x0 yb9 w1d h3f">
            <div class="t m0 x5 h2e yba ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybb ff3 fs4 fc2 sc3 ls0 ws0">________________________</div>
            <div class="t m0 x5 h2e ybc ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybd ff3 fs4 fc2 sc3 ls0 ws0">_________________________</div>
            <div class="t m0 x5 h2e ybe ff3 fs4 fc2 sc3 ls0 ws0">____</div>
            <div class="t m0 x5 h2e ybf ff3 fs4 fc2 sc3 ls0 ws0">Firma Jefe de Dependencia</div>
            <div class="t m0 x5 h2e yc0 ff3 fs4 fc2 sc3 ls0 ws0">Firma Gerente de Proyecto</div>
        </div>
        <div class="c x28 yc1 w23 h40"><div class="t m0 x20 h2e yc2 ff3 fs4 fc2 sc3 ls0 ws0">Carmen Marlene Rojas Gallego</div></div>
        <div class="c x34 yc1 w21 h40"><div class="t m0 x15 h2e yc2 ff3 fs4 fc2 sc3 ls0 ws0">Yeimi Viviana Agudo Rodriguez</div></div>
        <div class="c x0 yc3 w2e h41"><div class="t m0 x44 h2e yc4 ff3 fs4 fc2 sc3 ls0 ws0">Coordinadora Académica</div></div>
        <div class="c x33 yc3 w25 h41"><div class="t m0 x42 h2e yc4 ff3 fs4 fc2 sc3 ls0 ws0">Directora Territorial</div></div>
        <div class="c x0 yc5 w2c h42"><div class="t m0 x5 h43 yc6 ff3 fs8 fc2 sc3 ls0 ws0">Elaboró: Carmen Marlene Rojas, Profesional Especializado</div></div>
        <div class="c x31 yc7 w1b h44">
            <div class="t m0 x0 h26 yc8 ff1 fs4 fc2 sc2 ls0 ws0">La información recolectada en este</div>
            <div class="t m0 xe h26 yc9 ff1 fs4 fc2 sc2 ls0 ws0">documento es tratada bajo la política de</div>
            <div class="t m0 x10 h26 yca ff1 fs4 fc2 sc2 ls0 ws0">Datos Personales de la ESAP en</div>
            <div class="t m0 x15 h26 ycb ff1 fs4 fc2 sc2 ls0 ws0">cumplimiento a la Ley1581de2012</div>
        </div>
        <div class="c x0 ycc w2c h42"><div class="t m0 x5 h43 ycd ff3 fs8 fc2 sc3 ls0 ws0">Revisó: Carmen Marlene Rojas, Profesional Especializado</div></div>
        <div class="c x0 yc7 w2c h42"><div class="t m0 x5 h43 yce ff3 fs8 fc2 sc3 ls0 ws0">Aprobó: Yeimi Viviana Agudo, Directora Territorial</div></div>
    </div>
    <div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div>
</div>


		
            
        </div>
        <!-- ---------------------------------- -->
        <!-- End Component: Visor PDF -->
        <!-- ---------------------------------- -->


        <!-- ---------------------------------- -->
        <!-- Component: Programming Modal -->
        <!-- ---------------------------------- -->
        <div v-if="showProgrammingModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 modal">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-lg mx-4">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">Programación</h3>
                        <button @click="closeProgrammingModal" class="text-gray-400 hover:text-gray-500">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <label for="programmingDateRange" class="block text-sm font-medium text-gray-700">Seleccionar Rango de Fechas</label>
                            <input type="text" id="programmingDateRange" ref="programmingDateRangePicker" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div v-if="programmingEventsJson" class="mt-4">
                            <label class="block text-sm font-medium text-gray-700">Total eventos: {{ programmingEventsJson ? JSON.parse(programmingEventsJson).length : 0 }}</label>
                            <pre class="bg-gray-100 p-4 rounded-md overflow-auto max-h-60">{{ programmingEventsJson }}</pre>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button type="button" @click="closeProgrammingModal" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Cerrar
                        </button>
                        <button type="button" @click="generateProgrammingJson" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Aceptar
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- ---------------------------------- -->
        <!-- End Component: Programming Modal -->
        <!-- ---------------------------------- -->


    </div>
  
    <!-- JavaScript and Vue app initialization -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.47/dist/vue.global.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <script src="https://visjs.github.io/vis-timeline/standalone/umd/vis-timeline-graph2d.min.js"></script>    
    <!-- Include jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Add JSZip and FileSaver.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<!-- ---------------------------------- -->
<!-- Component: JavaScript and Vue app initialization -->
<!-- ---------------------------------- -->
<script>
// ----------------------------------
// Component: Vue Setup and Imports
// ----------------------------------
const { createApp, ref, onMounted, onUnmounted, nextTick, computed, reactive } = Vue;

// Mock data for terceros
const mockTerceros = [
    { id: '1', ccTercero: 'CC001', nombreTercero: 'Juan Pérez', inicialTercero: 'JP', tipoDocumentoTercero: '03', numeroDocumentoTercero: '12345678', props: { tipoTercero: 'CONTRATISTA', baseLiquidacion: '5000000', cargoServidor: 'Contratista', entidadBancaria: 'BANCOLOMBIA', cuentaBancaria: '1234567890', tipoCuenta: 'Ahorro', telefono: '3001234567', correo: 'juan.perez@example.com', fechaNacimiento: '1980-05-15', contrato: 'C001' } },
    { id: '2', ccTercero: 'CC002', nombreTercero: 'María Gómez', inicialTercero: 'MG', tipoDocumentoTercero: '03', numeroDocumentoTercero: '87654321', props: { tipoTercero: 'CATEDRATICO', baseLiquidacion: '3000000', cargoServidor: 'Hora Catedra', entidadBancaria: 'BANCO DAVIVIENDA', cuentaBancaria: '0987654321', tipoCuenta: 'Corriente', telefono: '3109876543', correo: 'maria.gomez@example.com', fechaNacimiento: '1990-08-22', contrato: 'C002' } },
    { id: '3', ccTercero: 'CC003', nombreTercero: 'Carlos López', inicialTercero: 'CL', tipoDocumentoTercero: '03', numeroDocumentoTercero: '11223344', props: { tipoTercero: 'SERVIDOR', baseLiquidacion: '4000000', cargoServidor: 'Servidor', entidadBancaria: 'BANCO DE BOGOTA', cuentaBancaria: '4567891234', tipoCuenta: 'Ahorro', telefono: '3204567890', correo: 'carlos.lopez@example.com', fechaNacimiento: '1975-03-10', contrato: 'C003' } }
];

// Mock data source simulation
const TerceroDataSource = async () => {
    return new Promise((resolve) => {
        setTimeout(() => resolve([...mockTerceros]), 500);
    });
};

// Mock data for cities
const mockCities = [
    { id: '1', nombreCiudad: 'CALI', departamento: 'VALLE', categoria: 1 },
    { id: '2', nombreCiudad: 'BOGOTA', departamento: 'CUNDINAMARCA', categoria: 2 },
    { id: '3', nombreCiudad: 'MEDELLIN', departamento: 'ANTIOQUIA', categoria: 1 },
    { id: '4', nombreCiudad: 'CARTAGENA', departamento: 'BOLIVAR', categoria: 3 },
    { id: '5', nombreCiudad: 'BARRANQUILLA', departamento: 'ATLANTICO', categoria: 2 },
    { id: '6', nombreCiudad: 'PEREIRA', departamento: 'RISARALDA', categoria: 1 }
];

// Mock data source simulation for cities
const CityDataSource = async () => {
    return new Promise((resolve) => {
        setTimeout(() => resolve([...mockCities]), 500);
    });
};
// ----------------------------------
// End Component: Vue Setup and Imports
// ----------------------------------

// ----------------------------------
// Component: Vue App Initialization
// ----------------------------------
const app = createApp({
    setup() {
        // ----------------------------------
        // Component: State management
        // ----------------------------------
        const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        const currentView = ref('dayGridMonth');
        const calendarApi = ref(null);
        const events = ref(JSON.parse(localStorage.getItem('academicEvents')) || []);
        const showModal = ref(false);
        const currentEvent = ref(null);
        const error = ref(null);
        const dateRangePicker = ref(null);
        const limitEvents = ref(true);
        const form = ref({
            title: '',
            description: '',
            startDate: '',
            endDate: '',
            color: '#3b82f6',
            terceroId: '',
            viatica: true,
            transporte: '',
            origen: '',
            destino: '',
            rutaAdicional: ''
        });
        const showProgrammingModal = ref(false);
        const programmingDateRangePicker = ref(null);
        const programmingRange = ref({ start: '', end: '' });
        const programmingEventsJson = ref(null);
        const showTercerosModal = ref(false);
        const terceros = ref([]);
        const searchQuery = ref('');
        const showOptions = ref(false);
        const currentTercero = ref(null);
        const showTerceroForm = ref(false);
        const terceroForm = ref({
            id: '',
            ccTercero: '',
            nombreTercero: '',
            inicialTercero: '',
            tipoDocumentoTercero: '03',
            numeroDocumentoTercero: '',
            props: {
                tipoTercero: 'CONTRATISTA',
                baseLiquidacion: '',
                cargoServidor: 'Servidor',
                entidadBancaria: 'BANCOLOMBIA',
                cuentaBancaria: '',
                tipoCuenta: 'Ahorro',
                telefono: '',
                correo: '',
                fechaNacimiento: '',
                contrato: ''
            }
        });
        let flatpickrInstance = null;
        let programmingFlatpickrInstance = null;
        const showPeriodoModal = ref(false);
        const periodos = ref(JSON.parse(localStorage.getItem('periodos')) || []);
        const currentPeriodo = ref(null);
        const periodoForm = ref({
            periodo: '2025-1',
            centro: 'CALI',
            programa: 'ADMINISTRACION PUBLICA',
            semestres: Array(10).fill(false),
            asignaturas: {}
        });
        const showTimeline = ref(false);
        const timelineContainer = ref(null);
        let timeline = null;
        const timelineModalState = reactive({
            isOpen: false,
            action: 'add',
            eventData: { id: '', content: '', group: '', start: '', end: '' }
        });
        const DEPENDENCIA = "0072DP - DECANATURA PREGRADO";
        const viaticos = ref([]);
	const isGeneratingPDF = ref(false);    
        const showVisorPDF = ref(false);
        const disabledButtons = ref({
            month: false,
            week: false,
            today: false,
            periodo: false,
            timeline: false,
            visorPDF: false,
            terceros: false,
            programming: false,
            eventLimit: false
        });
        // ----------------------------------
        // End Component: State management
        // ----------------------------------

        // ----------------------------------
        // Component: Button State Management
        // ----------------------------------
        const updateButtonStates = () => {
            if (showTimeline.value) {
                disabledButtons.value = {
                    month: true,
                    week: true,
                    today: true,
                    periodo: true,
                    timeline: false,
                    visorPDF: true,
                    terceros: true,
                    programming: true,
                    eventLimit: true
                };
            } else if (showVisorPDF.value) {
                disabledButtons.value = {
                    month: true,
                    week: true,
                    today: true,
                    periodo: true,
                    timeline: true,
                    visorPDF: false,
                    terceros: true,
                    programming: true,
                    eventLimit: true
                };
            } else {
                disabledButtons.value = {
                    month: false,
                    week: false,
                    today: false,
                    periodo: false,
                    timeline: false,
                    visorPDF: false,
                    terceros: false,
                    programming: false,
                    eventLimit: currentView.value !== 'dayGridMonth'
                };
            }
        };
        // ----------------------------------
        // End Component: Button State Management
        // ----------------------------------

        // ----------------------------------
        // Component: Terceros Management
        // ----------------------------------
        const loadTerceros = async () => {
            terceros.value = await TerceroDataSource();
        };

        const filteredTerceros = computed(() => {
            if (!searchQuery.value) return terceros.value;
            return terceros.value.filter(tercero => 
                tercero.nombreTercero.toLowerCase().includes(searchQuery.value.toLowerCase())
            );
        });

        const filterTerceros = () => {
            showOptions.value = true;
        };

        const selectTercero = (tercero) => {
            form.value.terceroId = tercero.id;
            form.value.title = tercero.nombreTercero;
            searchQuery.value = tercero.nombreTercero;
            showOptions.value = false;
        };

        const hideOptions = () => {
            setTimeout(() => {
                showOptions.value = false;
            }, 200);
        };

        const openTercerosModal = async () => {
            if (showTimeline.value || showVisorPDF.value) return;
            showTercerosModal.value = true;
            showTerceroForm.value = false;
            await loadTerceros();
            updateButtonStates();
        };

        const closeTercerosModal = () => {
            showTercerosModal.value = false;
            showTerceroForm.value = false;
            currentTercero.value = null;
            updateButtonStates();
        };

        const openTerceroForm = () => {
            showTerceroForm.value = true;
            currentTercero.value = null;
            terceroForm.value = {
                id: '',
                ccTercero: '',
                nombreTercero: '',
                inicialTercero: '',
                tipoDocumentoTercero: '03',
                numeroDocumentoTercero: '',
                props: {
                    tipoTercero: 'CONTRATISTA',
                    baseLiquidacion: '',
                    cargoServidor: 'Servidor',
                    entidadBancaria: 'BANCOLOMBIA',
                    cuentaBancaria: '',
                    tipoCuenta: 'Ahorro',
                    telefono: '',
                    correo: '',
                    fechaNacimiento: '',
                    contrato: ''
                }
            };
        };

        const closeTerceroForm = () => {
            showTerceroForm.value = false;
            currentTercero.value = null;
        };

        const editTercero = (tercero) => {
            currentTercero.value = tercero;
            terceroForm.value = JSON.parse(JSON.stringify(tercero));
            showTerceroForm.value = true;
        };

        const saveTercero = () => {
            if (!terceroForm.value.nombreTercero || !terceroForm.value.numeroDocumentoTercero) {
                alert('El nombre y el número de documento son requeridos.');
                return;
            }
            if (currentTercero.value) {
                const index = terceros.value.findIndex(t => t.id === currentTercero.value.id);
                if (index !== -1) terceros.value[index] = { ...terceroForm.value };
            } else {
                const newTercero = { ...terceroForm.value, id: Date.now().toString() };
                terceros.value.push(newTercero);
            }
            closeTerceroForm();
        };

        const deleteTercero = (id) => {
            if (confirm('¿Estás seguro de eliminar este tercero?')) {
                terceros.value = terceros.value.filter(t => t.id !== id);
            }
        };
        // ----------------------------------
        // End Component: Terceros Management
        // ----------------------------------

        // ----------------------------------
        // Component: Cities Management
        // ----------------------------------
        const cities = ref([]);
        const origenQuery = ref('');
        const destinoQuery = ref('');
        const showOrigenOptions = ref(false);
        const showDestinoOptions = ref(false);

        const loadCities = async () => {
            cities.value = await CityDataSource();
        };

        const filteredOrigenCities = computed(() => {
            if (!origenQuery.value) return cities.value;
            return cities.value.filter(city => 
                city.nombreCiudad.toLowerCase().includes(origenQuery.value.toLowerCase())
            );
        });

        const filteredDestinoCities = computed(() => {
            if (!destinoQuery.value) return cities.value;
            return cities.value.filter(city => 
                city.nombreCiudad.toLowerCase().includes(destinoQuery.value.toLowerCase())
            );
        });

        const filterOrigenCities = () => {
            showOrigenOptions.value = true;
        };

        const filterDestinoCities = () => {
            showDestinoOptions.value = true;
        };

        const selectOrigenCity = (city) => {
            form.value.origen = city.id;
            origenQuery.value = city.nombreCiudad;
            showOrigenOptions.value = false;
        };

        const selectDestinoCity = (city) => {
            form.value.destino = city.id;
            destinoQuery.value = city.nombreCiudad;
            showDestinoOptions.value = false;
        };

        const hideOrigenOptions = () => {
            setTimeout(() => {
                showOrigenOptions.value = false;
            }, 200);
        };

        const hideDestinoOptions = () => {
            setTimeout(() => {
                showDestinoOptions.value = false;
            }, 200);
        };
        // ----------------------------------
        // End Component: Cities Management
        // ----------------------------------

        // ----------------------------------
        // Component: Calendar Management
        // ----------------------------------
        const getTitle = () => {
            if (!calendarApi.value) return '';
            const view = calendarApi.value.view;
            if (view.type === 'dayGridMonth') {
                const date = view.currentStart;
                return `${monthNames[date.getMonth()]} ${date.getFullYear()}`;
            } else if (view.type === 'dayGridWeek') {
                const start = view.currentStart;
                const end = view.currentEnd;
                end.setDate(end.getDate() - 1);
                if (start.getMonth() === end.getMonth()) {
                    return `${start.getDate()} - ${end.getDate()} ${monthNames[start.getMonth()]} ${start.getFullYear()}`;
                } else if (start.getFullYear() === end.getFullYear()) {
                    return `${start.getDate()} ${monthNames[start.getMonth()].substring(0, 3)} - ${end.getDate()} ${monthNames[end.getMonth()].substring(0, 3)} ${start.getFullYear()}`;
                } else {
                    return `${start.getDate()} ${monthNames[start.getMonth()].substring(0, 3)} ${start.getFullYear()} - ${end.getDate()} ${monthNames[end.getMonth()].substring(0, 3)} ${end.getFullYear()}`;
                }
            }
            return '';
        };

        const darkenColor = (color, percent) => {
            if (!color) return '#3b82f6';
            if (color.startsWith('#')) {
                const num = parseInt(color.replace("#", ""), 16);
                const amt = Math.round(2.55 * percent);
                const R = Math.max(0, (num >> 16) - amt);
                const G = Math.max(0, (num >> 8 & 0x00FF) - amt);
                const B = Math.max(0, (num & 0x0000FF) - amt);
                return `#${(0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1)}`;
            }
            return '#2563eb';
        };

        const navigate = (direction) => {
            if (!calendarApi.value || showTimeline.value || showVisorPDF.value) return;
            if (direction === 'prev') calendarApi.value.prev();
            else if (direction === 'next') calendarApi.value.next();
            updateTitle();
        };

        const setView = (view) => {
            if (showTimeline.value || showVisorPDF.value) return;
            currentView.value = view;
            if (calendarApi.value) {
                calendarApi.value.changeView(view);
                if (view === 'dayGridMonth') {
                    calendarApi.value.setOption('dayMaxEventRows', limitEvents.value ? 4 : false);
                    calendarApi.value.setOption('dayMaxEvents', limitEvents.value ? 4 : false);
                } else if (view === 'dayGridWeek') {
                    calendarApi.value.setOption('dayMaxEventRows', false);
                    calendarApi.value.setOption('dayMaxEvents', false);
                }
                updateTitle();
                updateButtonStates();
            }
        };

        const goToToday = () => {
            if (!calendarApi.value || showTimeline.value || showVisorPDF.value) return;
            calendarApi.value.today();
            setView(currentView.value);
            updateTitle();
        };

        const toggleEventLimit = () => {
            if (showTimeline.value || showVisorPDF.value) return;
            limitEvents.value = !limitEvents.value;
            if (calendarApi.value && currentView.value === 'dayGridMonth') {
                calendarApi.value.setOption('dayMaxEventRows', limitEvents.value ? 4 : false);
                calendarApi.value.setOption('dayMaxEvents', limitEvents.value ? 4 : false);
            }
            updateButtonStates();
        };

        const updateTitle = () => {
            const titleElement = document.getElementById('calendar-title');
            if (titleElement) titleElement.textContent = getTitle();
        };

        const renderEvents = () => {
            if (!calendarApi.value || showTimeline.value || showVisorPDF.value) return;
            try {
                calendarApi.value.getEvents().forEach(event => event.remove());
                events.value.forEach(event => {
                    calendarApi.value.addEvent({
                        id: event.id,
                        title: event.title,
                        start: event.startDate,
                        end: event.endDate,
                        allDay: true,
                        backgroundColor: event.color || '#3b82f6',
                        borderColor: darkenColor(event.color, 20),
                        extendedProps: { 
                            description: event.description || '',
                            terceroId: event.terceroId || '',
                            viatica: event.viatica || false,
                            transporte: event.transporte || '',
                            origen: event.origen || '',
                            destino: event.destino || '',
                            rutaAdicional: event.rutaAdicional || ''
                        }
                    });
                });
            } catch (error) {
                console.error('Error in renderEvents:', error);
            }
        };

        const reinitializeCalendar = () => {
            try {
                const calendarEl = document.getElementById('calendar');
                if (!calendarEl) {
                    console.error('Calendar element not found');
                    return;
                }

                calendarEl.classList.remove('hidden');
                calendarEl.style.height = '100%';

                const savedView = currentView.value;
                const savedEvents = [...events.value];

                if (calendarApi.value) {
                    calendarApi.value.destroy();
                    calendarApi.value = null;
                }

                const calendar = new FullCalendar.Calendar(calendarEl, {
                    locale: 'es',
                    initialView: savedView,
                    headerToolbar: false,
                    firstDay: 1,
                    dayHeaderFormat: { weekday: 'long' },
                    height: '100%',
                    contentHeight: '100%',
                    eventClick: (info) => {
                        editEvent(info);
                    },
                    dateClick: function(info) {
                        openModal(info.dateStr);
                    },
                    eventDisplay: 'block',
                    eventTimeFormat: { hour: '2-digit', minute: '2-digit', hour12: false },
                    eventDidMount: function(info) {
                        if (info.event.allDay && info.event.start && info.event.end) {
                            const start = info.event.start;
                            const end = info.event.end;
                            const duration = (end - start) / (1000 * 60 * 60 * 24);
                            if (duration > 1) {
                                info.el.style.borderLeftWidth = '4px';
                                info.el.style.borderLeftStyle = 'solid';
                                info.el.style.borderLeftColor = darkenColor(info.event.backgroundColor, 20);
                            }
                        }
                    },
                    dayHeaderContent: function(arg) {
                        const dayName = arg.text.charAt(0).toUpperCase() + arg.text.slice(1);
                        return { html: `<div>${dayName}</div>` };
                    },
                    views: {
                        dayGridMonth: {
                            dayMaxEventRows: limitEvents.value ? 4 : false,
                            dayMaxEvents: limitEvents.value ? 4 : false,
                            fixedWeekCount: false,
                            aspectRatio: 1.5
                        },
                        dayGridWeek: {
                            type: 'dayGrid',
                            duration: { weeks: 1 },
                            dayCount: 7,
                            dayMaxEventRows: false,
                            dayMaxEvents: false,
                            titleFormat: { year: 'numeric', month: 'long', day: 'numeric' },
                            dayHeaderContent: function(arg) {
                                const dayName = arg.text.charAt(0).toUpperCase() + arg.text.slice(1);
                                const dayNumber = arg.date.getDate();
                                return {
                                    html: `
                                        <div class="flex flex-col items-center">
                                            <span class="fc-day-name">${dayName}</span>
                                            <span class="fc-day-number">${dayNumber}</span>
                                        </div>
                                    `
                                };
                            }
                        }
                    },
                    datesSet: function() {
                        updateTitle();
                    }
                });

                calendarApi.value = calendar;
                calendar.render();

                events.value = savedEvents;
                renderEvents();

                calendar.updateSize();

                const debounce = (func, wait) => {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                };

                const handleResize = debounce(() => {
                    if (calendarApi.value) {
                        calendarApi.value.updateSize();
                    }
                }, 100);

                window.addEventListener('resize', handleResize);

                nextTick(() => {
                    window.removeEventListener('resize', handleResize);
                });

                updateButtonStates();
            } catch (error) {
                console.error('Error reinitializing calendar:', error);
            }
        };
        // ----------------------------------
        // End Component: Calendar Management
        // ----------------------------------

        // ----------------------------------
        // Component: Event Management
        // ----------------------------------
        const openModal = (date) => {
            if (showTimeline.value || showVisorPDF.value) return;
            if (date) {
                form.value.startDate = date;
                form.value.endDate = date;
            } else if (!currentEvent.value) {
                const today = new Date().toISOString().split('T')[0];
                form.value.startDate = today;
                form.value.endDate = today;
            }
            showModal.value = true;

            nextTick(() => {
                if (dateRangePicker.value) {
                    flatpickrInstance = flatpickr(dateRangePicker.value, {
                        mode: 'range',
                        dateFormat: 'Y-m-d',
                        locale: 'es',
                        defaultDate: [form.value.startDate, form.value.endDate],
                        onChange: (selectedDates) => {
                            if (selectedDates.length === 2) {
                                form.value.startDate = selectedDates[0].toISOString().split('T')[0];
                                form.value.endDate = selectedDates[1].toISOString().split('T')[0];
                            }
                        },
                        onReady: (selectedDates, dateStr, instance) => {
                            if ((date && form.value.startDate === form.value.endDate) || currentEvent.value) {
                                dateRangePicker.value.value = `${form.value.startDate} a ${form.value.endDate}`;
                            }
                        },
                        onOpen: (selectedDates, dateStr, instance) => {
                            if ((date && form.value.startDate === form.value.endDate) || currentEvent.value) {
                                dateRangePicker.value.value = `${form.value.startDate} a ${form.value.endDate}`;
                            }
                        }
                    });

                    if ((date && form.value.startDate === form.value.endDate) || currentEvent.value) {
                        dateRangePicker.value.value = `${form.value.startDate} a ${form.value.endDate}`;
                    }
                }
            });
        };

        const closeModal = () => {
            showModal.value = false;
            currentEvent.value = null;
            error.value = null;
            form.value = {
                title: '',
                description: '',
                startDate: '',
                endDate: '',
                color: '#3b82f6',
                terceroId: '',
                viatica: true,
                transporte: '',
                origen: '',
                destino: '',
                rutaAdicional: ''
            };
            searchQuery.value = '';
            showOptions.value = false;
            origenQuery.value = '';
            destinoQuery.value = '';
            showOrigenOptions.value = false;
            showDestinoOptions.value = false;
            if (flatpickrInstance) {
                flatpickrInstance.destroy();
                flatpickrInstance = null;
            }
        };

        const computeViatico = () => {
            const eventToUse = currentEvent.value || form.value;
            if (eventToUse.terceroId && eventToUse.destino) {
                const viaticoObj = createViaticoObject(eventToUse, terceros.value, cities.value);
                if (viaticoObj && !viaticos.value.some(v => v.event.startDate === viaticoObj.event.startDate && v.tercero.numeroDocumentoTercero === viaticoObj.tercero.numeroDocumentoTercero)) {
                    viaticos.value.push(viaticoObj);
                }
            }
        };

        const editEvent = (eventInfo) => {
            if (showTimeline.value || showVisorPDF.value) return;
            const endDate = new Date(eventInfo.event.end || eventInfo.event.start);
            endDate.setDate(endDate.getDate() - 1);
            
            const origenCity = cities.value.find(city => city.id === eventInfo.event.extendedProps.origen);
            const destinoCity = cities.value.find(city => city.id === eventInfo.event.extendedProps.destino);

            currentEvent.value = {
                id: eventInfo.event.id,
                title: eventInfo.event.title,
                description: eventInfo.event.extendedProps.description || '',
                startDate: eventInfo.event.startStr.split('T')[0],
                endDate: endDate.toISOString().split('T')[0],
                color: eventInfo.event.backgroundColor || '#3b82f6',
                terceroId: eventInfo.event.extendedProps.terceroId || '',
                viatica: eventInfo.event.extendedProps.viatica || false,
                transporte: eventInfo.event.extendedProps.transporte || '',
                origen: eventInfo.event.extendedProps.origen || '',
                destino: eventInfo.event.extendedProps.destino || '',
                rutaAdicional: eventInfo.event.extendedProps.rutaAdicional || ''
            };

            form.value = { ...currentEvent.value };
            searchQuery.value = form.value.title;
            origenQuery.value = origenCity ? origenCity.nombreCiudad : '';
            destinoQuery.value = destinoCity ? destinoCity.nombreCiudad : '';
            computeViatico();
            openModal();
        };

        const saveEvent = () => {
            if (!form.value.title) {
                error.value = 'El título es requerido';
                return;
            }
            if (!form.value.startDate || !form.value.endDate) {
                error.value = 'Las fechas son requeridas';
                return;
            }
            const startDate = new Date(form.value.startDate);
            const endDate = new Date(form.value.endDate);
            if (startDate > endDate) {
                error.value = 'La fecha de inicio no puede ser posterior a la fecha final';
                return;
            }
            error.value = null;
            const startDateStr = `${form.value.startDate}T00:00:00`;
            const adjustedEndDate = new Date(form.value.endDate);
            adjustedEndDate.setDate(adjustedEndDate.getDate() + 1);
            const endDateStr = adjustedEndDate.toISOString().split('T')[0] + 'T00:00:00';

            const eventData = {
                id: currentEvent.value ? currentEvent.value.id : Date.now().toString(),
                title: form.value.title,
                description: form.value.description,
                startDate: startDateStr,
                endDate: endDateStr,
                color: form.value.color,
                terceroId: form.value.terceroId,
                viatica: form.value.viatica,
                transporte: form.value.transporte,
                origen: form.value.origen,
                destino: form.value.destino,
                rutaAdicional: form.value.rutaAdicional
            };

            if (currentEvent.value) {
                const index = events.value.findIndex(e => e.id === currentEvent.value.id);
                if (index !== -1) events.value[index] = eventData;
            } else {
                events.value.push(eventData);
            }
            localStorage.setItem('academicEvents', JSON.stringify(events.value));
            renderEvents();
            closeModal();
        };

        const deleteEvent = () => {
            if (currentEvent.value) {
                events.value = events.value.filter(e => e.id !== currentEvent.value.id);
                localStorage.setItem('academicEvents', JSON.stringify(events.value));
                renderEvents();
                closeModal();
            }
        };

        const createViaticoObject = (eventData, terceros, cities) => {
            if (!eventData) return null;

            const tercero = terceros.find(t => t.id === eventData.terceroId);
            const destinoCity = cities.find(c => c.id === eventData.destino);
            if (!tercero || !destinoCity) return null;

            const startDate = new Date(eventData.startDate);
            const endDate = new Date(eventData.endDate);
            const duration = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;

            const formatDate = (date) => {
                const d = new Date(date);
                return `${d.getDate().toString().padStart(2, '0')}/${(d.getMonth() + 1).toString().padStart(2, '0')}/${d.getFullYear()}`;
            };

            const calculateCost = (duration, cityCategory) => {
                const rates = {
                    1: 150000,
                    2: 200000,
                    3: 250000
                };
                return duration * (rates[cityCategory] || 150000);
            };

            return {
                dependencia: DEPENDENCIA,
                currentDate: formatDate(new Date('2025-05-04')),
                duracion: duration,
                tercero: {
                    nombreTercero: tercero.nombreTercero,
                    nacimiento: tercero.props.fechaNacimiento ? formatDate(tercero.props.fechaNacimiento) : '',
                    numeroDocumentoTercero: tercero.numeroDocumentoTercero,
                    correo: tercero.props.correo,
                    telefono: tercero.props.telefono,
                    entidadBancaria: tercero.props.entidadBancaria,
                    cargoServidor: tercero.props.cargoServidor,
                    tipoCuenta: tercero.props.tipoCuenta,
                    tipoTercero: tercero.props.tipoTercero,
                    cuentaBancaria: tercero.props.cuentaBancaria
                },
                event: {
                    startDate: formatDate(eventData.startDate),
                    endDate: formatDate(eventData.endDate),
                    description: eventData.description || '',
                    transporte: eventData.transporte || '0',
                    itinerario: eventData.rutaAdicional || '',
                    ciudadDestino: destinoCity.nombreCiudad,
                    ciudadDestinoDepartamento: destinoCity.departamento
                },
                cost: calculateCost(duration, destinoCity.categoria),
                eventId: eventData.id
            };
        };
        // ----------------------------------
        // End Component: Event Management
        // ----------------------------------

        // ----------------------------------
        // Component: Event Modal Input Formatting
        // ----------------------------------
        const formatTransporte = (value) => {
            const digitsOnly = value.replace(/\D/g, '');
            return digitsOnly.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        };

        const handleTransporteInput = (event) => {
            const input = event.target.value.replace(/,/g, '');
            if (/^\d*$/.test(input)) {
                form.value.transporte = formatTransporte(input);
            } else {
                form.value.transporte = formatTransporte(input.replace(/\D/g, ''));
            }
        };

        const handleRutaAdicionalInput = (event) => {
            let value = event.target.value;
            value = value.replace(/[^a-zA-Z\s]/g, '');
            form.value.rutaAdicional = value.toUpperCase();
        };

        const handleDescriptionInput = (event) => {
            let value = event.target.value;
            value = value.replace(/[^a-zA-Z0-9\-\s]/g, '');
            if (value.length > 120) {
                value = value.substring(0, 120);
            }
            form.value.description = value.toUpperCase();
        };
        // ----------------------------------
        // End Component: Event Modal Input Formatting
        // ----------------------------------

        // ----------------------------------
        // Component: Programming Management
        // ----------------------------------
        const computeViaticoForProgramming = () => {
            console.log('[computeViaticoForProgramming] Starting computation...');
            console.log('[computeViaticoForProgramming] Terceros count:', terceros.value.length);
            console.log('[computeViaticoForProgramming] Cities count:', cities.value.length);
            console.log('[computeViaticoForProgramming] Events count:', events.value.length);

            if (!terceros.value.length || !cities.value.length) {
                console.warn('[computeViaticoForProgramming] Terceros or cities not loaded. Cannot compute viáticos.');
                viaticos.value = [];
                return;
            }

            if (!programmingRange.value.start || !programmingRange.value.end) {
                console.warn('[computeViaticoForProgramming] No date range selected. Setting default range.');
                const today = new Date();
                const start = new Date(today.getFullYear(), today.getMonth(), 1);
                const end = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                programmingRange.value.start = start.toISOString().split('T')[0];
                programmingRange.value.end = end.toISOString().split('T')[0];
            }

            console.log('[computeViaticoForProgramming] Date range:', {
                start: programmingRange.value.start,
                end: programmingRange.value.end
            });

            const startDate = new Date(programmingRange.value.start);
            const endDate = new Date(programmingRange.value.end);
            endDate.setDate(endDate.getDate() + 1); // Include end date in range

            const filteredEvents = events.value.filter(event => {
                const eventStart = new Date(event.startDate);
                const isWithinRange = eventStart >= startDate && eventStart <= endDate;
                const hasRequiredFields = event.terceroId && event.destino;
                console.log('[computeViaticoForProgramming] Filtering event:', {
                    eventId: event.id,
                    startDate: event.startDate,
                    isWithinRange,
                    hasTercero: !!event.terceroId,
                    hasDestino: !!event.destino,
                    included: isWithinRange && hasRequiredFields
                });
                return isWithinRange && hasRequiredFields;
            });

            console.log('[computeViaticoForProgramming] Filtered events:', filteredEvents.map(e => ({
                id: e.id,
                startDate: e.startDate,
                terceroId: e.terceroId,
                destino: e.destino
            })));

            const newViaticos = filteredEvents
                .map(event => {
                    const viatico = createViaticoObject(event, terceros.value, cities.value);
                    console.log('[computeViaticoForProgramming] Created viatico for event:', {
                        eventId: event.id,
                        viatico: viatico ? {
                            eventId: viatico.eventId,
                            tercero: viatico.tercero.nombreTercero,
                            startDate: viatico.event.startDate,
                            destino: viatico.event.ciudadDestino
                        } : null
                    });
                    return viatico;
                })
                .filter(viatico => viatico !== null);

            // Remove duplicates based on eventId
            viaticos.value = newViaticos.filter((viatico, index, self) =>
                index === self.findIndex(v => v.eventId === viatico.eventId)
            );

            // Force reactivity update
            viaticos.value = reactive([...viaticos.value]);

            console.log('[computeViaticoForProgramming] Computed viáticos:', viaticos.value.map(v => ({
                eventId: v.eventId,
                tercero: v.tercero.nombreTercero,
                startDate: v.event.startDate,
                destino: v.event.ciudadDestino,
                cost: v.cost
            })));

            if (!viaticos.value.length) {
                console.warn('[computeViaticoForProgramming] No viáticos generated for the selected date range.');
            } else {
                console.log('[computeViaticoForProgramming] Total viáticos generated:', viaticos.value.length);
            }
        };

        const generateProgrammingJson = () => {
            console.log('[generateProgrammingJson] Starting...');
            console.log('[generateProgrammingJson] Initial state:', {
                tercerosCount: terceros.value.length,
                citiesCount: cities.value.length,
                eventsCount: events.value.length,
                programmingRange: programmingRange.value,
                viaticosCount: viaticos.value.length
            });

            if (!terceros.value.length || !cities.value.length) {
                console.error('[generateProgrammingJson] Error: Terceros or cities not loaded.');
                alert('Error: Terceros o ciudades no están cargados.');
                return;
            }

            if (!programmingRange.value.start || !programmingRange.value.end) {
                console.warn('[generateProgrammingJson] No date range selected.');
                alert('Por favor, selecciona un rango de fechas.');
                return;
            }

            console.log('[generateProgrammingJson] Computing viáticos...');
            computeViaticoForProgramming();

            console.log('[generateProgrammingJson] Viaticos after computation:', {
                count: viaticos.value.length,
                details: viaticos.value.map(v => ({
                    eventId: v.eventId,
                    tercero: v.tercero.nombreTercero,
                    startDate: v.event.startDate,
                    endDate: v.event.endDate,
                    destino: v.event.ciudadDestino,
                    cost: v.cost
                }))
            });

            const startDate = new Date(programmingRange.value.start);
            const endDate = new Date(programmingRange.value.end);
            endDate.setDate(endDate.getDate() + 1); // Include end date

            console.log('[generateProgrammingJson] Filtering events for JSON...', {
                startDate: startDate.toISOString(),
                endDate: endDate.toISOString()
            });

            const filteredEvents = events.value.filter(event => {
                const eventStart = new Date(event.startDate);
                const isWithinRange = eventStart >= startDate && eventStart <= endDate;
                const hasRequiredFields = event.terceroId && event.destino;
                console.log('[generateProgrammingJson] Event filter:', {
                    eventId: event.id,
                    startDate: event.startDate,
                    isWithinRange,
                    hasTercero: !!event.terceroId,
                    hasDestino: !!event.destino,
                    included: isWithinRange && hasRequiredFields
                });
                return isWithinRange && hasRequiredFields;
            });

            console.log('[generateProgrammingJson] Filtered events for JSON:', filteredEvents.map(e => ({
                id: e.id,
                startDate: e.startDate,
                terceroId: e.terceroId,
                destino: e.destino
            })));

            const eventsWithViatico = filteredEvents.map(event => {
                const viatico = viaticos.value.find(v => v.eventId === event.id);
                console.log('[generateProgrammingJson] Mapping event:', {
                    eventId: event.id,
                    hasViatico: !!viatico,
                    viatico: viatico ? {
                        tercero: viatico.tercero.nombreTercero,
                        startDate: viatico.event.startDate,
                        destino: viatico.event.ciudadDestino
                    } : null
                });
                return {
                    ...event,
                    viatico: viatico || null
                };
            });

            programmingEventsJson.value = JSON.stringify(eventsWithViatico, null, 2);
            console.log('[generateProgrammingJson] Generated JSON:', programmingEventsJson.value);

            // Force reactivity update
            programmingEventsJson.value = reactive(programmingEventsJson.value);

            console.log('[generateProgrammingJson] Final viaticos state:', {
                count: viaticos.value.length,
                details: viaticos.value.map(v => ({
                    eventId: v.eventId,
                    tercero: v.tercero.nombreTercero,
                    startDate: v.event.startDate,
                    destino: v.event.ciudadDestino
                }))
            });

            // Close modal and toggle Visor PDF
            showProgrammingModal.value = false;
            nextTick(() => {
                console.log('[generateProgrammingJson] Toggling Visor PDF...');
                if (showVisorPDF.value) {
                    toggleVisorPDF(); // Briefly toggle off
                    nextTick(() => toggleVisorPDF()); // Toggle back on
                } else {
                    toggleVisorPDF();
                }
                debugViaticos();
                console.log('[generateProgrammingJson] Completed.');
            });
        };

        const openProgrammingModal = () => {
            if (showTimeline.value || showVisorPDF.value) return;
            showProgrammingModal.value = true;
            updateButtonStates();

            nextTick(() => {
                if (programmingDateRangePicker.value) {
                    programmingFlatpickrInstance = flatpickr(programmingDateRangePicker.value, {
                        mode: 'range',
                        dateFormat: 'Y-m-d',
                        locale: 'es',
                        defaultDate: [programmingRange.value.start, programmingRange.value.end],
                        onChange: (selectedDates) => {
                            if (selectedDates.length === 2) {
                                programmingRange.value.start = selectedDates[0].toISOString().split('T')[0];
                                programmingRange.value.end = selectedDates[1].toISOString().split('T')[0];
                            }
                        },
                        onReady: (selectedDates, dateStr, instance) => {
                            if (programmingRange.value.start && programmingRange.value.end) {
                                programmingDateRangePicker.value.value = `${programmingRange.value.start} a ${programmingRange.value.end}`;
                            }
                        },
                        onOpen: (selectedDates, dateStr, instance) => {
                            if (programmingRange.value.start && programmingRange.value.end) {
                                programmingDateRangePicker.value.value = `${programmingRange.value.start} a ${programmingRange.value.end}`;
                            }
                        }
                    });

                    if (programmingRange.value.start && programmingRange.value.end) {
                        programmingDateRangePicker.value.value = `${programmingRange.value.start} a ${programmingRange.value.end}`;
                    }
                }
            });
        };

        const closeProgrammingModal = () => {
            showProgrammingModal.value = false;
            programmingRange.value = { start: '', end: '' };
            if (programmingFlatpickrInstance) {
                programmingFlatpickrInstance.destroy();
                programmingFlatpickrInstance = null;
            }
            updateButtonStates();
        };
        // ----------------------------------
        // End Component: Programming Management
        // ----------------------------------
        
        // ----------------------------------
        // Component: Visor PDF Management
        // ----------------------------------
        const debugViaticos = () => {
            console.log('[debugViaticos] Debugging viaticos...');
            console.log('[debugViaticos] Viaticos count:', viaticos.value.length);
            viaticos.value.forEach((viatico, index) => {
                console.log(`[debugViaticos] Viatico ${index}:`, {
                    tercero: viatico.tercero.nombreTercero,
                    startDate: viatico.event.startDate,
                    endDate: viatico.event.endDate,
                    destino: viatico.event.ciudadDestino,
                    eventId: viatico.eventId,
                    cost: viatico.cost
                });
                const element = document.getElementById(`pf1-${index}`);
                console.log(`[debugViaticos] Element pf1-${index} exists:`, !!element);
            });
        };

        const toggleVisorPDF = () => {
            showVisorPDF.value = !showVisorPDF.value;
            showTimeline.value = false;

            const calendarEl = document.getElementById('calendar');
            const timelineEl = document.getElementById('timeline');
            const visorPDFEl = document.getElementById('visorPDF');

            if (showVisorPDF.value) {
                if (calendarEl) calendarEl.classList.add('hidden');
                if (timelineEl) timelineEl.classList.add('hidden');
                if (visorPDFEl) visorPDFEl.classList.remove('hidden');
                nextTick(() => debugViaticos());
            } else {
                if (calendarEl) calendarEl.classList.remove('hidden');
                if (timelineEl) timelineEl.classList.add('hidden');
                if (visorPDFEl) visorPDFEl.classList.add('hidden');
                nextTick(() => {
                    if (calendarApi.value) {
                        calendarApi.value.render();
                        renderEvents();
                        calendarApi.value.updateSize();
                    } else {
                        reinitializeCalendar();
                    }
                });
            }
            updateButtonStates();
        };

        const generatePDF = async () => {
	      if (viaticos.value.length === 0) {
	        console.warn('[generatePDF] No viáticos available for PDF generation.');
	        alert('No hay viáticos para generar el PDF.');
	        return;
	      }
	
	      if (typeof window.html2canvas !== 'function') {
	        console.error('[generatePDF] html2canvas is not loaded.');
	        alert('Error: No se puede generar el PDF porque html2canvas no está disponible.');
	        return;
	      }
	
	      if (typeof JSZip !== 'function') {
	        console.error('[generatePDF] JSZip is not loaded.');
	        alert('Error: No se puede generar el ZIP porque JSZip no está disponible.');
	        return;
	      }
	
	      if (typeof saveAs !== 'function') {
	        console.error('[generatePDF] FileSaver.js is not loaded.');
	        alert('Error: No se puede guardar el ZIP porque FileSaver.js no está disponible.');
	        return;
	      }
	
	      isGeneratingPDF.value = true; // Show loading modal
	      console.log('[generatePDF] Started PDF generation, showing loading modal.');
	
	      const { jsPDF } = window.jspdf;
	      const zip = new JSZip();
	      let pdfCount = 0;
	
	      // Sort viáticos by tercero.nombreTercero for consistent numbering
	      const sortedViaticos = [...viaticos.value].sort((a, b) =>
	        a.tercero.nombreTercero.localeCompare(b.tercero.nombreTercero)
	      );
	
	      // Define letter size in pixels at 72 DPI
	      const letterWidthPx = 612; // 8.5 inches * 72 DPI
	      const letterHeightPx = 792; // 11 inches * 72 DPI
	
	      for (let index = 0; index < sortedViaticos.length; index++) {
	        const pageElement = document.getElementById(`pf1-${index}`);
	        if (!pageElement) {
	          console.warn(`[generatePDF] Page element pf1-${index} not found. Skipping.`);
	          continue;
	        }
	
	        try {
	          // Create a new jsPDF instance for each viático with letter size
	          const doc = new jsPDF({
	            orientation: 'portrait',
	            unit: 'px',
	            format: [letterWidthPx, letterHeightPx],
	            compression: true
	          });
	
	          const originalDisplay = pageElement.style.display;
	          pageElement.style.display = 'block';
	
	          // Calculate scale for higher quality
	          const elementWidth = pageElement.offsetWidth;
	          const elementHeight = pageElement.offsetHeight;
	          const scale = Math.min(letterWidthPx / elementWidth, letterHeightPx / elementHeight) * 2.0; // Increased to 2.0 for ~400 KB
	
	          const canvas = await window.html2canvas(pageElement, {
	            scale: scale,
	            useCORS: true,
	            logging: true,
	            width: elementWidth,
	            height: elementHeight,
	            windowWidth: elementWidth,
	            windowHeight: elementHeight
	          });
	
	          pageElement.style.display = originalDisplay;
	
	          // Convert canvas to JPEG with high quality (0.95)
	          const imgData = canvas.toDataURL('image/jpeg', 0.95); // 95% quality
	          const imgProps = doc.getImageProperties(imgData);
	          const pdfWidth = doc.internal.pageSize.getWidth();
	          const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
	
	          // Add image with medium compression
	          doc.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight, undefined, 'MEDIUM');
	          console.log(`[generatePDF] Generated PDF for viático ${index + 1}.`);
	
	          // Generate unique filename
	          const terceroName = sortedViaticos[index].tercero.nombreTercero.replace(/\s+/g, '_');
	          const destinoCity = sortedViaticos[index].event.ciudadDestino.replace(/\s+/g, '_');
	          const startDate = sortedViaticos[index].event.startDate.split('/').join('-');
	          const paddedIndex = String(index + 1).padStart(2, '0');
	          const filename = `${paddedIndex}_${terceroName}_${destinoCity}_${startDate}_${index + 1}.pdf`;
	
	          // Convert PDF to blob and add to ZIP
	          const pdfBlob = doc.output('blob');
	          zip.file(filename, pdfBlob, { compression: 'DEFLATE', compressionOptions: { level: 6 } });
	          pdfCount++;
	          console.log(`[generatePDF] Added to ZIP: ${filename}, size: ${(pdfBlob.size / 1024).toFixed(2)} KB`);
	        } catch (error) {
	          console.error(`[generatePDF] Error generating PDF for viático ${index + 1}:`, error);
	          alert(`Error al generar el PDF para el viático ${index + 1}: ${error.message}. Continuando con los demás viáticos.`);
	        }
	      }
	
	      if (pdfCount > 0) {
	        try {
	          // Generate ZIP file with compression and trigger download
	          const zipBlob = await zip.generateAsync({
	            type: 'blob',
	            compression: 'DEFLATE',
	            compressionOptions: { level: 6 }
	          });
	          saveAs(zipBlob, `comision_servicios_${new Date().toISOString().split('T')[0]}.zip`);
	          console.log('[generatePDF] Saved ZIP file with', pdfCount, 'PDFs, size:', (zipBlob.size / 1024 / 1024).toFixed(2), 'MB');
	        } catch (error) {
	          console.error('[generatePDF] Error generating ZIP file:', error);
	          alert('Error al generar el archivo ZIP: ' + error.message);
	        }
	      } else {
	        console.warn('[generatePDF] No valid PDFs generated for ZIP.');
	        alert('No se generaron PDFs válidos para incluir en el ZIP.');
	      }
	
	      isGeneratingPDF.value = false; // Hide loading modal
	      console.log('[generatePDF] Completed PDF generation, hiding loading modal.');
	    };
        // ----------------------------------
        // End Component: Visor PDF Management
        // ----------------------------------

        // ----------------------------------
        // Component: Lifecycle Hooks
        // ----------------------------------
        onMounted(async () => {
            console.log('[onMounted] Initializing app...');
            await loadTerceros();
            await loadCities();
            console.log('[onMounted] Loaded:', {
                terceros: terceros.value.length,
                cities: cities.value.length
            });

            const calendarEl = document.getElementById('calendar');
            const calendar = new FullCalendar.Calendar(calendarEl, {
                locale: 'es',
                initialView: currentView.value,
                headerToolbar: false,
                firstDay: 1,
                dayHeaderFormat: { weekday: 'long' },
                height: '100%',
                contentHeight: '100%',
                eventClick: (info) => {
                    editEvent(info);
                },
                dateClick: function(info) {
                    openModal(info.dateStr);
                },
                eventDisplay: 'block',
                eventTimeFormat: { hour: '2-digit', minute: '2-digit', hour12: false },
                eventDidMount: function(info) {
                    if (info.event.allDay && info.event.start && info.event.end) {
                        const start = info.event.start;
                        const end = info.event.end;
                        const duration = (end - start) / (1000 * 60 * 60 * 24);
                        if (duration > 1) {
                            info.el.style.borderLeftWidth = '4px';
                            info.el.style.borderLeftStyle = 'solid';
                            info.el.style.borderLeftColor = darkenColor(info.event.backgroundColor, 20);
                        }
                    }
                },
                dayHeaderContent: function(arg) {
                    const dayName = arg.text.charAt(0).toUpperCase() + arg.text.slice(1);
                    return { html: `<div>${dayName}</div>` };
                },
                views: {
                    dayGridMonth: {
                        dayMaxEventRows: limitEvents.value ? 4 : false,
                        dayMaxEvents: limitEvents.value ? 4 : false,
                        fixedWeekCount: false,
                        aspectRatio: 1.5
                    },
                    dayGridWeek: {
                        type: 'dayGrid',
                        duration: { weeks: 1 },
                        dayCount: 7,
                        dayMaxEventRows: false,
                        dayMaxEvents: false,
                        titleFormat: { year: 'numeric', month: 'long', day: 'numeric' },
                        dayHeaderContent: function(arg) {
                            const dayName = arg.text.charAt(0).toUpperCase() + arg.text.slice(1);
                            const dayNumber = arg.date.getDate();
                            return {
                                html: `
                                    <div class="flex flex-col items-center">
                                        <span class="fc-day-name">${dayName}</span>
                                        <span class="fc-day-number">${dayNumber}</span>
                                    </div>
                                `
                            };
                        }
                    }
                },
                datesSet: function() {
                    updateTitle();
                }
            });

            calendarApi.value = calendar;
            calendar.render();
            renderEvents();
            updateButtonStates();
            console.log('[onMounted] Calendar initialized.');
        });

        onUnmounted(() => {
            console.log('[onUnmounted] Cleaning up...');
            if (calendarApi.value) {
                calendarApi.value.destroy();
                calendarApi.value = null;
            }
            if (timeline) {
                timeline.destroy();
                timeline = null;
            }
            if (flatpickrInstance) {
                flatpickrInstance.destroy();
                flatpickrInstance = null;
            }
            if (programmingFlatpickrInstance) {
                programmingFlatpickrInstance.destroy();
                programmingFlatpickrInstance = null;
            }
        });
        // ----------------------------------
        // End Component: Lifecycle Hooks
        // ----------------------------------

	 const openPeriodoModal = () => { };
	 const toggleTimeline = () => { };

        // ----------------------------------
        // Component: Exposed methods and properties
        // ----------------------------------
        return {
            currentView,
            setView,
            navigate,
            goToToday,
            getTitle,
            limitEvents,
            toggleEventLimit,
            showModal,
            currentEvent,
            form,
            error,
            dateRangePicker,
            saveEvent,
            closeModal,
            deleteEvent,
            handleTransporteInput,
            handleRutaAdicionalInput,
            handleDescriptionInput,
            createViaticoObject,
            viaticos,
            showProgrammingModal,
            openProgrammingModal,
            closeProgrammingModal,
            programmingDateRangePicker,
            programmingEventsJson,
            generateProgrammingJson,
            showTercerosModal,
            openTercerosModal,
            closeTercerosModal,
            terceros,
            searchQuery,
            showOptions,
            filteredTerceros,
            filterTerceros,
            selectTercero,
            hideOptions,
            showTerceroForm,
            openTerceroForm,
            closeTerceroForm,
            terceroForm,
            currentTercero,
            editTercero,
            saveTercero,
            deleteTercero,
            cities,
            origenQuery,
            destinoQuery,
            showOrigenOptions,
            showDestinoOptions,
            filteredOrigenCities,
            filteredDestinoCities,
            filterOrigenCities,
            filterDestinoCities,
            selectOrigenCity,
            selectDestinoCity,
            hideOrigenOptions,
            hideDestinoOptions,            
            showVisorPDF,
            toggleVisorPDF,
	    isGeneratingPDF,
            generatePDF,
            computeViatico,
            computeViaticoForProgramming,
            reinitializeCalendar,
            disabledButtons,
            debugViaticos,
	    openPeriodoModal, 
	    toggleTimeline,
	    showTimeline,
    	    toggleTimeline
        };
        // ----------------------------------
        // End Component: Exposed methods and properties
        // ----------------------------------
    }
});

app.mount('#app');
</script>
<!-- ---------------------------------- -->
<!-- End Component: JavaScript and Vue app initialization -->
<!-- ---------------------------------- -->
</body>
</html>
